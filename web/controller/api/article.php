<?phpnamespace api;use Move\db;use Move\ext\page;class article extends api{	public function __construct()	{		parent::__construct();	}	public function index()	{		echo 'welcome to article!';	}	public function lists()	{		$type = isset($_GET['type']) ? $_GET['type'] : 0;		$where["status"] = 1;		if ($type) $where["type_id"] = $type;		$res = parent::pullpage("article", $where, "id,username,title,value as content,addtime", '`sort` asc ,addtime desc,id desc', 10);		if (!$res) {			ajax('已到最底部', -9);		}		foreach ($res['list'] as $_key => $_art) {			preg_match_all('/<img.*?src="(.*?)".*?>/is', $res['list'][$_key]['content'], $img);			$res['list'][$_key]['img'] = isset($img['1']['1']) ? $img['1']['1'] : "";			$res['list'][$_key]['content'] = mb_substr(strip_tags($_art['content']), 0, 100, 'utf-8');			if (!$res['list'][$_key]['content']) $res['list'][$_key]['content'] = '暂无内容';			$res['list'][$_key]['addtime'] = date('m-d H:i', $_art['addtime']);		}		ajax($res, 1);	}	public function shows()	{		$id = isset($_GET['id']) ? (int)$_GET['id'] : "1";		$arr = db::table("article")->where(["status" => 1, "id" => $id])->find();		$ret = array('id' => $arr['id'], 'date' => date('m-d H:i', time()), 'source' => $arr['username'], 'title' => $arr['title'], 'content' => $arr['value'] ? $arr['value'] : '暂无内容');		ajax($ret, 1);	}	public function articletype()	{		$check = isset($_GET['movesay']) ? ($_GET['movesay'] == "movesay123" ? 1 : 0) : 0;		if (!$check) {			echo 'article check';			die;		}		$type = db::table("article_type")->where(["status" => 1])->field("id,name,title")->select();		if ($type) {			ajax($type, 1);		} else {			ajax('查找失败');		}	}} 