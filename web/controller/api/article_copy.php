<?phpnamespace api;use Move\db;use Move\ext\page;class article extends api{	public function __construct()	{		parent::__construct();	}	public function index()	{		echo 'welcome to article!';	}	public function lists()	{		if (isset($_GET['start']) && check($_GET['start'], 'd')) {			$start = trim($_GET['start']);		} else {			$start = 0;		}		$limit = $start + 10;		$where = [];		$type_id = isset($_GET['type_id']) ? trim($_GET['type_id']) : '';		if ($type_id && check($type_id, 'd')) {			$where["type_id"] = $type_id;		}		$where["status"] = 1;		$list = db::table("article")->where($where)->order("sort asc ,id desc ,addtime desc")->limit($start, $limit)->select();		$data = [];		foreach ($list as $k => $v) {			$data[$k]['jian'] = mb_substr(strip_tags($v['value']), 0, 130) . '...';			$pattern = "/<[img|IMG].*?src=[\'|\"](.*?(?:[\.gif|\.jpg|\.png]))[\'|\"].*?[\/]?>/";			preg_match($pattern, $v['value'], $match);			if ($match) {				$data[$k]['img'] = $match[1];			} else {				$data[$k]['img'] = '/static/default/home/img/noimg.png';			}			$data[$k]['title'] = $v['title'];			$data[$k]['username'] = $v['username'];			$data[$k]['addtime'] = addtime($v['addtime'], 'm-d H:i');		}		ajax($data, 1, $start);	}	public function shows()	{		$id = isset($_GET['id']) ? (int)$_GET['id'] : "1";		$arr = db::table("article")->where(["status" => 1, "id" => $id])->find();		$ret = ['id' => $arr['id'], 'date' => date('m-d H:i', time()), 'source' => $arr['username'], 'title' => $arr['title'], 'content' => $arr['value'] ? $arr['value'] : '暂无内容'];		ajax($ret, 1);	}	public function articletype()	{		$check = isset($_GET['movesay']) ? ($_GET['movesay'] == "movesay123" ? 1 : 0) : 0;		if (!$check) {			echo 'article check';			die;		}		$type = db::table("article_type")->where(["status" => 1])->field("id,name,title")->select();		if ($type) {			ajax($type, 1);		} else {			ajax('查找失败');		}	}} 