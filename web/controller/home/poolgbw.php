<?phpnamespace home;use Move\db;use Move\ext\page;class poolgbw extends home{	public function __construct()	{		parent::__construct();		$this->is_game('poolgbw');	}	public function index()	{		$this->set_title('矿机工厂');		$arr = db::table("poolgbw")->where(["userid" => session("userid"), "status#!=" => 0])->count();		$PageObj = new page($arr, 10);		$show = $PageObj->show();		$list = db::table("poolgbw")->where(["userid" => session("userid"), "status#!=" => 0])->order("`id` desc")->limit($PageObj->firstRow, $PageObj->listRows)->select();		$pages = ['show' => $show, 'list' => $list];		$this->assign('pages', $pages);		$this->display();	}	public function str()	{		$id = iv("post.id", "d", "参数错误");		$paypassword = iv("post.paypassword", "password", "交易密码格式错误");		if (!$this->userid) {			ajax("请先登录");		}		$res = md('poolgbw')->str($this->userid, $id, $paypassword);		if (isset($res[1]) && $res[1]) {			ajax($res[0], 1);		} else {			ajax($res[0]);		}	}	public function end()	{		$id = iv("post.id", "d", "参数错误");		if (!$this->userid) {			ajax("请先登录");		}		$res = md('poolgbw')->end($this->userid, $id);		if (isset($res[1]) && $res[1]) {			if (isset($res[2]) && $res[2]) {				ajax($res[0], 1, $res[2]);			}			ajax($res[0], 1);		} else {			ajax($res[0]);		}	}	public function get()	{		$id = iv("post.id", "d", "参数错误");		if (!$this->userid) {			ajax("请先登录");		}		$res = md('poolgbw')->get($this->userid, $id);		if (isset($res[1]) && $res[1]) {			if (isset($res[2]) && $res[2]) {				ajax($res[0], 1, $res[2]);			}			ajax($res[0], 1);		} else {			ajax($res[0]);		}	}	public function market()	{		$this->set_title('矿机工厂');		$arr = db::table("poolgbw_market")->where(["status" => 1])->count();		$PageObj = new page($arr, 15);		$show = $PageObj->show();		$list = db::table("poolgbw_market")->where(["status" => 1])->order("`id` asc")->limit($PageObj->firstRow, $PageObj->listRows)->select();		$pages = ['show' => $show, 'list' => $list];		$this->assign('pages', $pages);		$this->display();	}	public function log()	{		$this->set_title('矿机工厂');		$arr = db::table("poolgbw_log")->where(["userid" => session("userid")])->count();		$PageObj = new page($arr, 15);		$show = $PageObj->show();		$list = db::table("poolgbw_log")->where(["userid" => session("userid")])->order("`id` desc")->limit($PageObj->firstRow, $PageObj->listRows)->select();		$pages = ['show' => $show, 'list' => $list];		$this->assign('pages', $pages);		$this->display();	}	public function buy()	{		$id = iv("post.id", "d", "参数错误");		$paypassword = iv("post.paypassword", "password", "交易密码格式错误");		$num = 1;		if (!$this->userid) {			ajax("请先登录");		}		$res = md('poolgbw')->buy($this->userid, $id, $paypassword, $num);		if (isset($res[1]) && $res[1]) {			if (isset($res[2]) && $res[2]) {				ajax($res[0], 1, $res[2]);			}			ajax($res[0], 1);		} else {			ajax($res[0]);		}	}	public function order()	{		$this->set_title('矿机工厂');		$status = iv("status");		if (!$status) {			redirect("/poolgbw/index");			exit();		}		$arr = db::table("poolgbw")->where(["userid" => session("userid"), "status" => $status])->count();		$PageObj = new page($arr, 5);		$show = $PageObj->show();		$list = db::table("poolgbw")->where(["userid" => session("userid"), "status" => $status])->order("`id` desc")->limit($PageObj->firstRow, $PageObj->listRows)->select();		$pages = ['show' => $show, 'list' => $list];		$this->assign('pages', $pages);		$this->display("index");	}	public function rules()	{		$this->set_title('矿机工厂');		$des = db::table("poolgbw_shuoming")->where(["id" => 1])->find();		$this->assign("message", $des);		$this->display("rules");	}}