<?phpnamespace admin;use Move\db;use Move\config;use Move\cache;use Move\ext\page;use Move\ext\client;class cen_hangq extends admin{	public function __construct()	{	}	public function type_mr()	{		if (APP_DEMO) {			ajax('测试站暂时不能修改');		}		$id = iv('get.id');		if (empty($id)) {			ajax('请选择要操作的数据!');		}		$res = db::table('cen_hangq')->where(['id' => $id])->find();		if (!$res) {			ajax('不存在');		}		db::table('cen_hangq')->where(['mr' => 1, 'type' => $res['type']])->save(['mr' => 0]);		if (db::table('cen_hangq')->where(['id' => $id])->save(['mr' => 1])) {			ajax('操作成功！', 1);		} else {			ajax('操作失败！');		}	}	public function index()	{		$builder = new builder("cen_hangq");		$builder->title('币种管理', '这里是币种管理', '币种列表', '/cen_hangq/index')->button('add', '添加', '/cen_hangq/edit')->button('no', '禁用', '/cen_hangq/status/type/0')->button('off', '启用', '/cen_hangq/status/type/1')->button('del', '删除', '/cen_hangq/status/type/-1')->search('addtime_str', '开始时间', 'time')->search('addtime_end', '结束时间', 'time')->search('order', ['id_asc' => 'ID升序', 'id_desc' => 'ID降序', 'sort_asc' => '索引升序', 'sort_desc' => '索引降序', 'addtime_asc' => '时间升序', 'addtime_desc' => '时间降序',], 'select')->search('status', ['0' => '全部状态', '1' => '禁用', '2' => '启用'], 'select')->search('field', ['name' => '简称', 'title' => '币种名称',], 'select')->search('name', '请输入查询内容', 'text')->key('id', 'ID', 'text')->key('name', '简称', 'text')->key('title', '币种名称', 'text')->key('img', '图片', 'img')->key('sort', '排序', 'text')->key('addtime', '添加时间', 'time')->key('endtime', '更新时间', 'time')->key('status', '状态', 'select', [0 => '<span style="color:#DA9151;">禁用</span>', 1 => '<span style="color:#3498db;">启用</span>'])->key("ext", '操作', 'link', [['type' => 'button3', 'url' => '/cen_hangq/edit/id/###', 'title' => '编辑', 'field' => 'id', 'color' => '',],])->lists();	}	public function edit()	{		define('APP_DEMO', 0);		if (empty($_POST)) {			$id = input('get.id');			$builder = new builder("cen_hangq", ["id" => $id], "edit");			$builder->title(($id ? '编辑币种' : '添加币种'), ($id ? '这里是编辑币种' : '这里是添加币种'), '币种管理', '/cen_hangq/index');			if ($id) {				$builder->key('id', '编号', 'readonly', '', '数据编号');				$builder->key('id', '编号', 'hidden', '', '数据编号');			}			$builder->key('name', '简称', 'text', '', '币种简称 (只能字母)')->key('title', '币种名称', 'text', '', '币种名称')->key('img', '图片', 'image', '', '')->key('sf', '算法', 'text', '', '核心算法')->key('sort', '排序', 'text', '', '排序 (只能数字)')->key('market', '市场', 'text', '', '交易市场')->key('gw', '官网', 'text', '', '官方网站')->key('jj', '简介', 'text', '', '币种简介')->key('zl', '发行总量', 'text', '', '发行总量')->key('gj', '国家', 'text', '', '发行国家')->key('fs', '方式', 'text', '', '挖矿方式')->key('bag', '钱包', 'text', '', '钱包地址')->key('gk', '区块奖励', 'text', '', '区块奖励')->key('sl', '算力', 'text', '', '全网算力')->key('bz', '不足', 'text', '', '比重不足之处')->key('ts', '特色', 'text', '', '币种特色')->key('pt', '平台', 'text', '', '交易平台')->key('qu', '区块浏览', 'text', '', '区块浏览地址')->key('publishtime', '发布时间', 'text', '', '发布时间')->key('addtime', '添加时间', 'time', '', '添加时间 (只能时间)')->key('endtime', '更新时间', 'time', '', '更新时间 (只能时间)')->key('status', '状态', 'select', [0 => '禁用', 1 => '启用'], '状态')->edit();		} else {			if (APP_DEMO) {				ajax('测试站暂时不能修改');			}			$data['name'] = iv('post.name', 'w', '简称 格式错误', 1);			$data2['name'] = iv('post.name', 'w', '简称 格式错误', 1);			$data['title'] = iv('post.title', 'a', '币种名称 格式错误', 1);			$data['sf'] = iv('post.sf', 'a', '算法格式错误', 1);			$data['sort'] = iv('post.sort', 'd', '排序 格式错误', 1);			$data['market'] = iv('post.market', 'a', '交易市场格式错误', 1);			$data['gw'] = iv('post.gw', 'a', '官网格式错误', 1);			$data['jj'] = iv('post.jj', 'a', '币种简介格式错误', 1);			$data['zl'] = iv('post.zl', 'a', '币种发行总量格式错误', 1);			$data['gj'] = iv('post.gj', 'a', '国家格式错误', 1);			$data['fs'] = iv('post.fs', 'a', '挖矿方式格式错误', 1);			$data['bag'] = iv('post.bag', 'a', '钱包格式错误', 1);			$data['gk'] = iv('post.gk', 'a', '区块奖励格式错误', 1);			$data['sl'] = iv('post.sl', 'a', '全网算力格式错误', 1);			$data['bz'] = iv('post.bz', 'a', '币种不足之处格式错误', 1);			$data['ts'] = iv('post.ts', 'a', '币种特色格式错误', 1);			$data['pt'] = iv('post.pt', 'a', '交易平台格式错误', 1);			$data['qu'] = iv('post.qu', 'a', '区块浏览格式错误', 1);			$data['addtime'] = iv('post.addtime', 'time', '添加时间格式错误', 1);			$data['endtime'] = iv('post.endtime', 'time', '更新时间格式错误', 1);			$data['status'] = iv('post.status', 'd', '状态格式错误', 1);			$id = iv('post.id');			if (!$data['addtime']) {				$data['addtime'] = time();			}			if (!$data['endtime']) {				$data['endtime'] = time();			}			if ($id) {				$res = db::table('cen_hangq')->where(['id' => $id])->save($data);			} else {				$res = db::table('cen_hangq')->add($data);			}			if ($res) {				ajax('操作成功', 1);			} else {				ajax('操作失败');			}		}	}	public function status()	{		define('APP_DEMO', 0);		if (APP_DEMO) {			ajax('测试站暂时不能修改');		}		$id = input('post.id');		$type = input('get.type');		$builder = new builder();		$res = $builder->set_status($id, $type, 'cen_hangq');		if (isset($res[1])) {			ajax('操作成功', 1);		} else {			ajax('操作失败');		}	}}