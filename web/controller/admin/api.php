<?phpnamespace admin;use Move\db;class api extends admin{	public function __construct()	{		parent::__construct();		if (!$this->is_game('api')) {			ajax('这个应用你没有购买');		}	}	public function index()	{		if (empty($_POST)) {			$data['list'] = md('sys_config')->lists();			$builder = new builder();			$builder->data($data)->url()->title('API配置', '这里是API配置')->key('api_close', 'API状态', 'select', [0 => '禁止', 1 => '启用'], 'API状态,禁止后所有人不能使用')->edit();		} else {			if (APP_DEMO) {				ajax('测试站暂时不能修改');			}			$data['api_close'] = iv('post.api_close');			$res = 0;			foreach ($data as $k => $v) {				if (md('sys_config')->setValueOrName($k, $v)) {					$res = 1;				}			}			if ($res) {				mc("msphp_sys_config", null);				ajax('操作成功', 1);			} else {				ajax('操作失败');			}		}	}	public function log()	{		$builder = new builder("api");		$builder->title('API记录', '这里是API记录', '记录列表', '/api/log')->button('no', '禁用', '/api/log_status/type/0')->button('off', '启用', '/api/log_status/type/1')->button('del', '删除', '/api/log_status/type/-1')->search('addtime_str', '开始时间', 'time')->search('addtime_end', '结束时间', 'time')->search('order', ['id_desc' => 'ID降序', 'id_asc' => 'ID升序', 'sort_desc' => '索引降序', 'sort_asc' => '索引升序', 'addtime_desc' => '时间降序', 'addtime_asc' => '时间升序',], 'select')->search('status', ['0' => '全部状态', '1' => '禁用', '2' => '启用'], 'select')->search('field', ['userid_c_user_c_id_c_username' => '用户名',], 'select')->search('name', '请输入查询内容', 'text')->key('id', 'ID', 'text')->key('userid', '用户名', 'link', [['type' => 'button', 'url' => '/user/index/field/id/name/###', 'title' => ['from_id' => 'userid', 'table' => 'user', 'to_id' => 'id', 'title' => 'username'], 'field' => 'userid', 'color' => '',]])->key('key', '公钥', 'text')->key('secret_key', '私钥', 'text')->key('sort', '排序', 'text')->key('addtime', '添加时间', 'time')->key('endtime', '更新时间', 'time')->key('status', '状态', 'select', [0 => '<span style="color:#DA9151;">禁用</span>', 1 => '<span style="color:#3498db;">启用</span>'])->lists();	}	public function log_status()	{		if (APP_DEMO) {			ajax('测试站暂时不能修改');		}		$id = input('post.id');		$type = input('get.type');		$builder = new builder();		$res = $builder->set_status($id, $type, 'api');		if (isset($res[1])) {			ajax('操作成功', 1);		} else {			ajax('操作失败');		}	}}