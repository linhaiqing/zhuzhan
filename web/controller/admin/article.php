<?phpnamespace admin;use Move\db;use Move\ms;class article extends admin{	public $game_list = ["index" => "首页显示", "trade" => "交易页显示", "issue" => "认购页显示", "vote" => "投票页显示", "money" => "理财页显示", "fenhong" => "分红页显示", "pool" => "矿机页显示", "weike" => "威客页显示", "shop" => "商城页显示", "duobao" => "夺宝页显示", "bazaar" => "集市页显示", "qiandao" => "签到页显示", "hongbao" => "红包页显示", "app" => "APP首页显示", "duobao" => "夺宝页显示", "sweike" => "新威客页显示", "ico" => "ICO众筹", "huafei" => "充值缴费", 'otc' => '场外交易区'];	public function __construct()	{		parent::__construct();	}	public function index()	{		$builder = new builder("article");		$builder->title('文章管理', '<a href="http://www.movesay.com/article/detail/id/19.html" target="_blank"> 功能说明 http://www.movesay.com/article/detail/id/19.html</a>', '文章列表', '/article/index')->button('add', '添加', '/article/edit')->button('no', '禁用', '/article/status/type/0')->button('off', '启用', '/article/status/type/1')->button('del', '删除', '/article/status/type/-1')->search('addtime_str', '开始时间', 'time')->search('addtime_end', '结束时间', 'time')->search('order', ['id_desc' => 'ID降序', 'id_asc' => 'ID升序', 'sort_desc' => '索引降序', 'sort_asc' => '索引升序', 'addtime_desc' => '时间降序', 'addtime_asc' => '时间升序',], 'select')->search('status', ['0' => '全部状态', '1' => '禁用', '2' => '启用'], 'select')->search('field', ['title' => '文章标题', 'type_id_c_article_type_c_id_c_title' => '文章类型', 'lang_c_sys_lang_type_c_name_c_title' => '文章语言', 'username_c_admin_c_username_c_username' => '发布人',], 'select')->search('name', '请输入查询内容', 'text')->key('id', 'ID', 'text')->key('username', '发布人', 'text')->key('type_id', '类型', 'link', [['type' => 'button', 'url' => '/article/type/field/id/name/###', 'title' => ['from_id' => 'type_id', 'table' => 'article_type', 'to_id' => 'id', 'title' => 'title'], 'field' => 'username', 'color' => '',]])->key('lang', '语言', 'link', [['type' => 'button', 'url' => '/article/lang_type/field/name/name/###', 'title' => ['from_id' => 'lang', 'table' => 'sys_lang_type', 'to_id' => 'name', 'title' => 'title'], 'field' => 'lang', 'color' => '',]])->key('title', '标题', 'text')->key('sort', '排序', 'text')->key('addtime', '添加时间', 'time')->key('endtime', '更新时间', 'time')->key('status', '状态', 'select', [0 => '<span style="color:#DA9151;">禁用</span>', 1 => '<span style="color:#3498db;">启用</span>'])->key("ext", '操作', 'link', [['type' => 'button3', 'url' => '/article/edit/id/###', 'title' => '编辑', 'field' => 'id', 'color' => '',],])->lists();	}	public function edit()	{		if (empty($_POST)) {			$id = input('get.id');			$builder = new builder("article", ["id" => $id], "edit");			$builder->title(($id ? '编辑文章' : '添加文章'), '<a href="http://www.movesay.com/article/detail/id/19.html" target="_blank"> 功能说明 http://www.movesay.com/article/detail/id/19.html</a>', '文章管理', '/article/index');			if ($id) {				$builder->key('id', '编号', 'readonly', '', '数据编号');				$builder->key('id', '编号', 'hidden', '', '数据编号');			}			$builder->key('username', '发布人', 'select', 'admin_c_username_c_username', '名称');			$builder->key('title', '标题', 'text', '', '标题 (全部)');			$builder->key('type_id', '类型', 'select', 'article_type_c_id_c_title', '类型');			$builder->key('lang', '语言', 'select', 'sys_lang_type_c_name_c_title', '语言');			$builder->key('sort', '排序', 'text', '', '排序 (只能数字)');			$builder->key('value', '内容', 'editor', '', '内容 (全部)');			$builder->key('addtime', '添加时间', 'time', '', '添加时间 (只能时间)  不填会增自动生成');			$builder->key('status', '状态', 'select', [0 => '禁用', 1 => '启用'], '状态')->edit();		} else {			if (APP_DEMO) {				ajax('测试站暂时不能修改');			}			$data['title'] = iv('post.title', '', '标题格式错误', 1);			$data['type_id'] = iv('post.type_id', 'd', '类型格式错误', 1);			$data['lang'] = iv('post.lang', 'a', '语言格式错误', 1);			$data['sort'] = iv('post.sort', 'd', '排序格式错误 只能是数字', 1);			$data['value'] = iv('post.value');			$data['addtime'] = iv('post.addtime', 'time', '添加时间格式错误', 1);			$data['status'] = iv('post.status', 'd', '状态格式错误', 1);			$id = iv('post.id', 'd', '参数错误', 1);			$data['username'] = iv('post.username', 'a', '发布人格式错误');			if (!isset($data['endtime']) || !$data['endtime']) {				$data['endtime'] = time();			}			if ($id) {				$res = db::table('article')->where(['id' => $id])->save($data);			} else {				if (!isset($data['addtime']) || !$data['addtime']) {					$data['addtime'] = time();				}				$res = db::table('article')->add($data);			}			if ($res) {				ajax('操作成功', 1);			} else {				ajax('操作失败' . '[' . implode(',', $res) . ']');			}		}	}	public function status()	{		if (APP_DEMO) {			ajax('测试站暂时不能修改');		}		$id = input('post.id');		$type = input('get.type');		$builder = new builder();		$res = $builder->set_status($id, $type, 'article');		if (isset($res[1])) {			ajax('操作成功', 1);		} else {			ajax('操作失败');		}	}	public function type()	{		$builder = new builder("article_type");		$builder->title('文章类型', '<a href="http://www.movesay.com/article/detail/id/19.html" target="_blank"> 功能说明 http://www.movesay.com/article/detail/id/19.html</a>', '类型列表', '/article/type')->button('add', '添加', '/article/type_edit')->button('no', '禁用', '/article/type_status/type/0')->button('off', '启用', '/article/type_status/type/1')->button('del', '删除', '/article/type_status/type/-1')->search('addtime_str', '开始时间', 'time')->search('addtime_end', '结束时间', 'time')->search('order', ['id_desc' => 'ID降序', 'id_asc' => 'ID升序', 'sort_desc' => '索引降序', 'sort_asc' => '索引升序', 'addtime_desc' => '时间降序', 'addtime_asc' => '时间升序',], 'select')->search('status', ['0' => '全部状态', '1' => '禁用', '2' => '启用'], 'select')->search('field', ['name' => '名称', 'title' => '标题',], 'select')->search('name', '请输入查询内容', 'text')->key('id', 'ID', 'text')->key('title', '标题', 'text')->key('type', '类型', 'select', [1 => '普通文章', 2 => '底部文章', 3 => '帮助文章'])->key("mr", '默认', 'link', [['type' => 'button2', 'url' => '/article/type_mr/id/###', 'title' => '设为默认', 'field' => 'id', 'color' => '', 'ajax' => 'get', 'exts' => ["mr" => [0]],], ['type' => 'button2', 'url' => '', 'title' => '当前类型默认显示', 'field' => 'id', 'color' => '', 'ajax' => 'get', 'exts' => ["mr" => [1]],]])->key('sy', '首页显示', 'select', [0 => '<span style="color:#DA9151;">不显示</span>', 1 => '<span style="color:#3498db;">显示</span>'])->key('sort', '排序', 'text')->key('addtime', '添加时间', 'time')->key('endtime', '更新时间', 'time')->key('status', '状态', 'select', [0 => '<span style="color:#DA9151;">禁用</span>', 1 => '<span style="color:#3498db;">启用</span>'])->key("ext", '操作', 'link', [['type' => 'button3', 'url' => '/article/type_edit/id/###', 'title' => '编辑', 'field' => 'id', 'color' => '',],])->lists();	}	public function type_edit()	{		if (empty($_POST)) {			$id = input('get.id');			$builder = new builder("article_type", ["id" => $id], "edit");			$builder->title(($id ? '编辑文章类型' : '添加文章类型'), '<a href="http://www.movesay.com/article/detail/id/19.html" target="_blank"> 功能说明 http://www.movesay.com/article/detail/id/19.html</a>', '文章类型管理', '/article/type')->key('id', '编号', 'readonly', '', '数据编号')->key('id', '编号', 'hidden', '', '数据编号')->key('name', '名称', 'text', '', '名称 (只能字母)')->key('type', '类型', 'select', [1 => '普通文章', 2 => '底部文章', 3 => '帮助文章'], '类型')->key('sy', '首页显示', 'select', [1 => '显示', 0 => '不显示'], '首页显示')->key('title', '标题', 'text', '', '标题 (全部)')->key('sort', '排序', 'text', '', '排序 (只能数字)')->key('addtime', '添加时间', 'time', '', '添加时间 (只能时间)')->key('endtime', '更新时间', 'time', '', '更新时间 (只能时间)')->key('status', '状态', 'select', [0 => '禁用', 1 => '启用'], '状态')->edit();		} else {			if (APP_DEMO) {				ajax('测试站暂时不能修改');			}			$data['name'] = iv('post.name', 'w', '名称格式错误', 1);			$data['title'] = iv('post.title', 'a', '标题格式错误', 1);			$data['type'] = iv('post.type', 'd', '类型 格式错误', 1);			$data['sy'] = iv('post.sy', 'd', '首页显示 格式错误', 1);			$data['sort'] = iv('post.sort', 'a', '排序格式错误', 1);			$data['addtime'] = iv('post.addtime', 'time', '添加时间格式错误', 1);			$data['endtime'] = iv('post.endtime', 'time', '更新时间格式错误', 1);			$data['status'] = iv('post.status', 'd', '状态格式错误', 1);			$id = iv('post.id');			if (!$data['addtime']) {				$data['addtime'] = time();			}			if (!$data['endtime']) {				$data['endtime'] = time();			}			if ($id) {				$res = db::table('article_type')->where(['id' => $id])->save($data);			} else {				$res = db::table('article_type')->add($data);			}			if ($res) {				ajax('操作成功', 1);			} else {				ajax('操作失败');			}		}	}	public function type_status()	{		if (APP_DEMO) {			ajax('测试站暂时不能修改');		}		$id = input('post.id');		$type = input('get.type');		$builder = new builder();		$res = $builder->set_status($id, $type, 'article_type');		if (isset($res[1])) {			ajax('操作成功', 1);		} else {			ajax('操作失败');		}	}	public function type_mr()	{		if (APP_DEMO) {			ajax('测试站暂时不能修改');		}		$id = iv('get.id');		if (empty($id)) {			ajax('请选择要操作的数据!');		}		$res = db::table('article_type')->where(['id' => $id])->find();		if (!$res) {			ajax('不存在');		}		db::table('article_type')->where(['mr' => 1, 'type' => $res['type']])->save(['mr' => 0]);		if (db::table('article_type')->where(['id' => $id])->save(['mr' => 1])) {			ajax('操作成功！', 1);		} else {			ajax('操作失败！');		}	}	public function adver()	{		$builder = new builder("sys_ad");		$builder->title('广告管理', '<a href="http://www.movesay.com/article/detail/id/19.html" target="_blank"> 功能说明 http://www.movesay.com/article/detail/id/19.html</a>', '广告列表', '/article/adver')->button('add', '添加', '/article/adver_edit')->button('no', '禁用', '/article/adver_status/type/0')->button('off', '启用', '/article/adver_status/type/1')->button('del', '删除', '/article/adver_status/type/-1')->key('id', 'ID', 'text')->key('name', '名称', 'text')->key('title', '标题', 'text')->key('type', '类型', 'select', $this->game_list)->key('lang', '语言', 'link', [['type' => 'button', 'url' => '/article/lang_type/field/name/name/###', 'title' => ['from_id' => 'lang', 'table' => 'sys_lang_type', 'to_id' => 'name', 'title' => 'title'], 'field' => 'lang', 'color' => '',]])->key('img', '图片', 'img')->key('height', '高度', 'text')->key('url', '链接', 'text')->key('sort', '排序', 'text')->key('addtime', '添加时间', 'time')->key('endtime', '更新时间', 'time')->key('status', '状态', 'select', [0 => '<span style="color:#DA9151;">禁用</span>', 1 => '<span style="color:#3498db;">启用</span>'])->key("ext", '操作', 'link', [['type' => 'button3', 'url' => '/article/adver_edit/id/###', 'title' => '编辑', 'field' => 'id', 'color' => '',],])->lists();	}	public function adver_edit()	{		if (empty($_POST)) {			$id = input('get.id');			$builder = new builder("sys_ad", ["id" => $id], "edit");			$builder->title(($id ? '编辑广告' : '添加广告'), '<a href="http://www.movesay.com/article/detail/id/19.html" target="_blank"> 功能说明 http://www.movesay.com/article/detail/id/19.html</a>', '广告管理', '/article/adver');			if ($id) {				$builder->key('id', '编号', 'readonly', '', '数据编号');				$builder->key('id', '编号', 'hidden', '', '数据编号');			}			$builder->key('name', '名称', 'text', '', '名称 (只能字母)')->key('title', '标题', 'text', '', '标题')->key('type', '类型', 'select', $this->game_list, '类型')->key('lang', '语言', 'select', 'sys_lang_type_c_name_c_title', '语言')->key('img', '图片', 'image', '', '')->key('height', '高度', 'text', '', '同一页面的图片高度要设置一样')->key('url', '链接', 'text', '', '')->key('sort', '排序', 'text', '', '排序 (只能数字)')->key('addtime', '添加时间', 'time', '', '添加时间 (只能时间)')->key('endtime', '更新时间', 'time', '', '更新时间 (只能时间)')->key('status', '状态', 'select', [0 => '禁用', 1 => '启用'], '状态')->edit();		} else {			if (APP_DEMO) {				ajax('测试站暂时不能修改');			}			$data['name'] = iv('post.name', 'w', '名称 格式错误', 1);			$data['title'] = iv('post.title', 'a', '标题 格式错误', 1);			$data['type'] = iv('post.type', 'a', '类型 格式错误', 1);			$data['lang'] = iv('post.lang', 'a', '语言格式错误', 1);			$data['img'] = iv('post.img', 'a', '图片 格式错误', 1);			$data['height'] = iv('post.height', 'd', '高度 格式错误', 1);			$data['url'] = iv('post.url');			$data['sort'] = iv('post.sort', 'd', '排序 格式错误', 1);			$data['addtime'] = iv('post.addtime', 'time', '添加时间格式错误', 1);			$data['endtime'] = iv('post.endtime', 'time', '更新时间格式错误', 1);			$data['status'] = iv('post.status', 'd', '状态格式错误', 1);			$id = iv('post.id');			if (!$data['addtime']) {				$data['addtime'] = time();			}			if (!$data['endtime']) {				$data['endtime'] = time();			}			if ($id) {				$res = db::table('sys_ad')->where(['id' => $id])->save($data);			} else {				$res = db::table('sys_ad')->add($data);			}			if ($res) {				ajax('操作成功', 1);			} else {				ajax('操作失败');			}		}	}	public function adver_status()	{		if (APP_DEMO) {			ajax('测试站暂时不能修改');		}		$id = input('post.id');		$type = input('get.type');		$builder = new builder();		$res = $builder->set_status($id, $type, 'sys_ad');		if (isset($res[1])) {			ajax('操作成功', 1);		} else {			ajax('操作失败');		}	}	public function link()	{		$builder = new builder("sys_link");		$builder->title('友情链接', '<a href="http://www.movesay.com/article/detail/id/19.html" target="_blank"> 功能说明 http://www.movesay.com/article/detail/id/19.html</a>', '链接列表', '/article/link')->button('add', '添加', '/article/link_edit')->button('no', '禁用', '/article/link_status/type/0')->button('off', '启用', '/article/link_status/type/1')->button('del', '删除', '/article/link_status/type/-1')->search('addtime_str', '开始时间', 'time')->search('addtime_end', '结束时间', 'time')->search('order', ['id_desc' => 'ID降序', 'id_asc' => 'ID升序', 'sort_desc' => '索引降序', 'sort_asc' => '索引升序', 'addtime_desc' => '时间降序', 'addtime_asc' => '时间升序',], 'select')->search('status', ['0' => '全部状态', '1' => '禁用', '2' => '启用'], 'select')->search('field', ['name' => '名称', 'title' => '标题',], 'select')->search('name', '请输入查询内容', 'text')->key('id', 'ID', 'text')->key('name', '名称', 'text')->key('title', '标题', 'text')->key('img', '标题', 'img')->key('sort', '排序', 'text')->key('addtime', '添加时间', 'time')->key('endtime', '更新时间', 'time')->key('status', '状态', 'select', [0 => '<span style="color:#DA9151;">禁用</span>', 1 => '<span style="color:#3498db;">启用</span>'])->key("ext", '操作', 'link', [['type' => 'button3', 'url' => '/article/link_edit/id/###', 'title' => '编辑', 'field' => 'id', 'color' => '',],])->lists();	}	public function link_edit()	{		if (empty($_POST)) {			$id = input('get.id');			$builder = new builder("sys_link", ["id" => $id], "edit");			$builder->title(($id ? '编辑链接' : '添加链接'), '<a href="http://www.movesay.com/article/detail/id/19.html" target="_blank"> 功能说明 http://www.movesay.com/article/detail/id/19.html</a>', '链接管理', '/article/link')->key('id', '编号', 'readonly', '', '数据编号')->key('id', '编号', 'hidden', '', '数据编号')->key('name', '名称', 'text', '', '名称 (只能字母)')->key('img', '图片', 'image', '', '')->key('value', '链接', 'text', '', '')->key('title', '标题', 'text', '', '标题 (全部)')->key('sort', '排序', 'text', '', '排序 (只能数字)')->key('addtime', '添加时间', 'time', '', '添加时间 (只能时间)')->key('endtime', '更新时间', 'time', '', '更新时间 (只能时间)')->key('status', '状态', 'select', [0 => '禁用', 1 => '启用'], '状态')->edit();		} else {			if (APP_DEMO) {				ajax('测试站暂时不能修改');			}			$data['name'] = iv('post.name', '', '名称 格式错误', 1);			$data['title'] = iv('post.title', '', '标题 格式错误', 1);			$data['sort'] = iv('post.sort', '', '排序 格式错误', 1);			$data['img'] = iv('post.img', '', '图片 格式错误', 1);			$data['value'] = iv('post.value');			$data['addtime'] = iv('post.addtime', 'time', '添加时间格式错误', 1);			$data['endtime'] = iv('post.endtime', 'time', '更新时间格式错误', 1);			$data['status'] = iv('post.status', 'd', '状态格式错误', 1);			$id = iv('post.id');			if (!$data['addtime']) {				$data['addtime'] = time();			}			if (!$data['endtime']) {				$data['endtime'] = time();			}			if ($id) {				$res = db::table('sys_link')->where(['id' => $id])->save($data);			} else {				$res = db::table('sys_link')->add($data);			}			if ($res) {				ajax('操作成功', 1);			} else {				ajax('操作失败');			}		}	}	public function link_status()	{		if (APP_DEMO) {			ajax('测试站暂时不能修改');		}		$id = input('post.id');		$type = input('get.type');		$builder = new builder();		$res = $builder->set_status($id, $type, 'sys_link');		if (isset($res[1])) {			ajax('操作成功', 1);		} else {			ajax('操作失败');		}	}	public function lang()	{		$builder = new builder("sys_lang");		$lang_list = db::table("sys_lang_type")->select();		foreach ($lang_list as $k => $v) {			$lang_list_se[$v['name']] = $v['title'];		}		$builder->title('多语言', '<a href="http://www.movesay.com/article/detail/id/19.html" target="_blank"> 功能说明 http://www.movesay.com/article/detail/id/19.html</a>', '多语言列表', '/article/lang')->button('add', '添加', '/article/lang_edit')->button('del', '删除', '/article/lang_status/type/-1')->search('field', $lang_list_se, 'select')->search('name', '请输入查询内容', 'text')->key('id', 'ID', 'text')->key("ext", '操作', 'link', [['type' => 'button3', 'url' => '/article/lang_edit/id/###', 'title' => '编辑', 'field' => 'id', 'color' => '',],]);		$lang_list = db::table("sys_lang_type")->select();		foreach ($lang_list as $key => $val) {			if ($val['name'] == 'cn') {				$val['name'] = 'name';			}			if ($val['name'] != 'hk') {				$builder->key($val['name'], $val["title"], 'text');			}		}		$builder->lists();	}	public function lang_edit()	{		if (empty($_POST)) {			$id = input('get.id');			$builder = new builder("sys_lang", ["id" => $id], "edit");			$builder->title(($id ? '编辑多语言' : '添加多语言'), '<a href="http://www.movesay.com/article/detail/id/19.html" target="_blank"> 功能说明 http://www.movesay.com/article/detail/id/19.html</a>', '多语言管理', '/article/lang')->key('id', '编号', 'readonly', '', '数据编号')->key('id', '编号', 'hidden', '', '数据编号');			$lang_list = db::table("sys_lang_type")->select();			foreach ($lang_list as $key => $val) {				if ($val['name'] == 'cn') {					$val['name'] = 'name';				}				if ($val['name'] != 'hk') {					$builder->key($val['name'], $val["title"], 'text');				}			}			$builder->edit();		} else {			if (APP_DEMO) {				ajax('测试站暂时不能修改');			}			$data = iv('post');			$id = iv('post.id');			$data['en'] = iv('post.en');			if ($id) {				$res = db::table('sys_lang')->where(["id" => $id])->save($data);			} else {				if (db::table('sys_lang')->where(["name" => $data['name']])->find()) {					ajax($data['name'] . '已经存在');				}				$res = db::table('sys_lang')->add($data);			}			if ($res) {				ajax('操作成功', 1);			} else {				ajax('操作失败');			}		}	}	public function lang_status()	{		if (APP_DEMO) {			ajax('测试站暂时不能修改');		}		$id = input('post.id');		$type = input('get.type');		$builder = new builder();		$res = $builder->set_status($id, $type, 'sys_lang');		if (isset($res[1])) {			ajax('操作成功', 1);		} else {			ajax('操作失败');		}	}	public function lang_type()	{		$builder = new builder("sys_lang_type");		$builder->title('多语言', '<a href="http://www.movesay.com/article/detail/id/19.html" target="_blank"> 功能说明 http://www.movesay.com/article/detail/id/19.html</a>', '多语言列表', '/article/lang_type')->button('add', '添加', '/article/lang_type_edit')->button('no', '禁用', '/article/lang_type_status/type/0')->button('off', '启用', '/article/lang_type_status/type/1')->button('del', '删除', '/article/lang_type_status/type/-1')->search('field', ['name' => '名称',], 'select')->search('name', '请输入查询内容', 'text')->key('id', 'ID', 'text')->key('name', '名称', 'text')->key('title', '标题', 'text')->key('img', '图片', 'img')->key('status', '状态', 'select', [0 => '<span style="color:#DA9151;">禁用</span>', 1 => '<span style="color:#3498db;">启用</span>'])->key("ext", '操作', 'link', [['type' => 'button3', 'url' => '/article/lang_type_edit/id/###', 'title' => '编辑', 'field' => 'id', 'color' => '',],])->lists();	}	public function lang_type_edit()	{		if (empty($_POST)) {			$id = input('get.id');			$builder = new builder("sys_lang_type", ["id" => $id], "edit");			$builder->title(($id ? '编辑多语言' : '添加多语言'), '<a href="http://www.movesay.com/article/detail/id/19.html" target="_blank"> 功能说明 http://www.movesay.com/article/detail/id/19.html</a>', '多语言管理', '/article/lang_type')->key('id', '编号', 'readonly', '', '数据编号')->key('id', '编号', 'hidden', '', '数据编号')->key('name', '名称', 'text', '', '英文区分 默认的简体 繁体 英文 名称请不要修改')->key('title', '标题', 'text', '', '显示用')->key('img', '图片', 'img', '', '显示用')->key('status', '状态', 'select', [0 => '禁用', 1 => '启用'], '状态')->edit();		} else {			if (APP_DEMO) {				ajax('测试站暂时不能修改');			}			$data['name'] = iv('post.name');			$data['title'] = iv('post.title');			$data['img'] = iv('post.img');			$data['status'] = iv('post.status');			$id = iv('post.id');			if ($id) {				$res = db::table('sys_lang_type')->where(["id" => $id])->save($data);			} else {				if (db::table('sys_lang_type')->where(["name" => $data['name']])->find()) {					ajax($data['name'] . '已经存在');				}				$res = db::table('sys_lang_type')->add($data);				$sys_lang = db::table("sys_lang")->find();				if (!isset($sys_lang[$data['name']])) {					db::execute("ALTER TABLE `move_sys_lang` ADD `" . $data['name'] . "`  VARCHAR(255) NOT NULL;");				}			}			if ($res) {				ajax('操作成功', 1);			} else {				ajax('操作失败');			}		}	}	public function lang_type_status()	{		if (APP_DEMO) {			ajax('测试站暂时不能修改');		}		$id = input('post.id');		$type = input('get.type');		$res = db::table('sys_lang_type')->where(['id#in' => $id])->find();		if ($type == "-1") {			if ($res['name'] == 'cn' || $res['name'] == 'en' || $res['name'] == 'hk') {				ajax('当前语言不能删除');			}		}		$builder = new builder();		$rs = $builder->set_status($id, $type, 'sys_lang_type');		if (isset($rs[1])) {			ajax('操作成功', 1);		} else {			ajax('操作失败');		}	}	public function daohang()	{		$builder = new builder('sys_daohang');		$builder->title('导航配置', '', '导航列表', '/article/daohang')->button('add', '添加', '/article/daohang_edit')->button('no', '禁用', '/article/daohang_status/type/0')->button('off', '启用', '/article/daohang_status/type/1')->button('del', '删除', '/article/daohang_status/type/-1')->search('addtime_str', '开始时间', 'time')->search('addtime_end', '结束时间', 'time')->search('order', ['id_desc' => 'ID降序', 'id_asc' => 'ID升序', 'sort_desc' => '索引降序', 'sort_asc' => '索引升序', 'addtime_desc' => '时间降序', 'addtime_asc' => '时间升序',], 'select')->search('status', ['0' => '全部状态', '1' => '禁用', '2' => '启用'], 'select')->search('field', ['name' => '名称', 'title' => '标题',], 'select')->search('name', '请输入查询内容', 'text')->key('id', 'ID', 'text')->key('name', '名称', 'text')->key('title', '标题', 'text')->key('url', '连接', 'text')->key('sort', '排序', 'text')->key('addtime', '添加时间', 'time')->key('endtime', '更新时间', 'time')->key('status', '状态', 'select', [0 => '<span style="color:#DA9151;">禁用</span>', 1 => '<span style="color:#3498db;">启用</span>'])->key("ext", '操作', 'link', [['type' => 'button3', 'url' => '/article/daohang_edit/id/###', 'title' => '编辑', 'field' => 'id', 'color' => '',],])->lists();	}	public function daohang_edit()	{		if (empty($_POST)) {			$id = input('get.id');			$builder = new builder("sys_daohang", ["id" => $id], "edit");			$builder->title(($id ? '编辑导航' : '添加导航'), '', '导航管理', '/article/daohang')->key('id', '编号', 'readonly', '', '数据编号')->key('id', '编号', 'hidden', '', '数据编号')->key('name', '名称', 'text', '', '名称 (只能字母)')->key('title', '标题', 'text', '', '标题 (全部)')->key('url', '连接', 'text', '', '连接')->key('sort', '排序', 'text', '', '排序 (只能数字)')->key('addtime', '添加时间', 'time', '', '添加时间 (只能时间)')->key('endtime', '更新时间', 'time', '', '更新时间 (只能时间)')->key('status', '状态', 'select', [0 => '禁用', 1 => '启用'], '状态')->edit();		} else {			if (APP_DEMO) {				ajax('测试站暂时不能修改');			}			$data['name'] = iv('post.name', 'w', '名称格式错误');			$data['title'] = iv('post.title', 'a', '标题格式错误');			$data['url'] = iv('post.url', '', '连接格式错误');			$data['sort'] = iv('post.sort', 'a', '排序格式错误');			$data['addtime'] = iv('post.addtime', 'time', '添加时间格式错误');			$data['endtime'] = iv('post.endtime', 'time', '更新时间格式错误');			$data['status'] = iv('post.status', 'd', '状态格式错误');			$id = iv('post.id');			if ($id) {				$res = db::table('sys_daohang')->where(['id' => $id])->save($data);			} else {				$res = db::table('sys_daohang')->add($data);			}			if ($res) {				ajax('操作成功', 1);			} else {				ajax('操作失败');			}		}	}	public function daohang_status()	{		$id = input('post.id');		$type = input('get.type');		$builder = new builder();		$builder->set_status($id, $type, 'sys_daohang');	}}