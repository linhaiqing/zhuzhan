<?phpnamespace app;use Move\db;class vote extends home{	public function __construct()	{		parent::__construct();	}	public function index()	{		$banner = db::table("sys_ad")->where(["type" => "app"])->select();		foreach ($banner as $val) {			$res['banner'][] = $this->host . "/upload/" . $val["img"];		}		$where["status"] = 1;		$res = parent::pullpage("vote", $where, "id desc", 10);		foreach ($res["list"] as $k => $v) {			$res["list"][$k]['addtime'] = addtime($v["addtime"]);			$res["list"][$k]['img'] = $this->host . "/upload/" . $res["list"][$k]['img'];		}		ajax($res, 1);	}	public function up()	{		$this->userid = $this->userid();		if (!$this->userid) {			ajax('请登录', -99);		}		$id = iv('post.id', 'd', '参数错误');		$type = iv('post.type', 'd', '参数错误');		$ext = iv('post.ext', 'a', '参数错误');		$this->userid = $this->userid();		if (!$this->userid) {			ajax('请登录', -99);		}		if (!$type || !check($type, "d") && $type != 1 && $type != 2) {			ajax("投票类型格式错误");		}		if (!$ext || !check($ext, "a") || mb_strlen($ext) > 20) {			ajax("投票原因格式错误");		}		$res = md('vote')->up($this->userid, $id, $type, $ext);		if (isset($res[1]) && $res[1]) {			ajax($res[0], 1);		} else {			ajax($res[0]);		}	}}