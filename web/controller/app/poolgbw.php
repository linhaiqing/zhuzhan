<?phpnamespace app;use Move\db;use Move\ext\page;class poolgbw extends home{	public function __construct()	{		parent::__construct();	}	public function index()	{		$this->set_title('矿机工厂');		$status = iv("get.status");		$this->userid = $this->userid();		if (!$status) {			$where = ["userid" => $this->userid, "status#!=" => 0];		} else {			$where = ["userid" => $this->userid, "status" => $status];		}		$res = parent::pullpage("poolgbw", $where, "id desc", 10);		foreach ($res['list'] as $k => $v) {			if ($v['addtime'] != 0) {				$res['list'][$k]['addtime'] = addtime($v['addtime']);			} else {				$res['list'][$k]['addtime'] = '---';			}			if ($v['strtime'] != 0) {				$res['list'][$k]['strtime'] = addtime($v['strtime']);			} else {				$res['list'][$k]['strtime'] = '---';			}			if ($v['gettime'] != 0) {				$res['list'][$k]['gettime'] = addtime($v['gettime']);			} else {				$res['list'][$k]['gettime'] = '---';			}		}		ajax($res, 1);	}	public function str()	{		$this->userid = $this->userid();		$id = iv("post.id", "d", "参数错误");		$paypassword = iv("post.paypassword", "password", "交易密码格式错误");		if (!$this->userid) {			ajax("请先登录");		}		$res = md('poolgbw')->str($this->userid, $id, $paypassword);		if (isset($res[1]) && $res[1]) {			ajax($res[0], 1);		} else {			ajax($res[0]);		}	}	public function end()	{		$this->userid = $this->userid();		$id = iv("post.id", "d", "参数错误");		if (!$this->userid) {			ajax("请先登录");		}		$res = md('poolgbw')->end($this->userid, $id);		if (isset($res[1]) && $res[1]) {			if (isset($res[2]) && $res[2]) {				ajax($res[0], 1, $res[2]);			}			ajax($res[0], 1);		} else {			ajax($res[0]);		}	}	public function get()	{		$this->userid = $this->userid();		$id = iv("post.id", "d", "参数错误");		if (!$this->userid) {			ajax("请先登录");		}		$res = md('poolgbw')->get($this->userid, $id);		if (isset($res[1]) && $res[1]) {			if (isset($res[2]) && $res[2]) {				ajax($res[0], 1, $res[2]);			}			ajax($res[0], 1);		} else {			ajax($res[0]);		}	}	public function market()	{		$this->set_title('矿机工厂');		$where = ["status" => 1];		$res = parent::pullpage("poolgbw_market", $where, "id asc", 10);		ajax($res, 1);	}	public function log()	{		$this->userid = $this->userid();		$this->set_title('矿机工厂');		$where = ["userid" => $this->userid];		$res = parent::pullpage("poolgbw_log", $where, "id desc", 10);		foreach ($res['list'] as $k => $v) {			$res['list'][$k]['gettime'] = addtime($v['gettime'], '');		}		ajax($res, 1);	}	public function buy()	{		$this->userid = $this->userid();		$id = iv("post.id", "d", "参数错误");		$paypassword = iv("post.paypassword", "password", "交易密码格式错误");		$num = 1;		if (!$this->userid) {			ajax("请先登录");		}		$res = md('poolgbw')->buy($this->userid, $id, $paypassword, $num);		if (isset($res[1]) && $res[1]) {			if (isset($res[2]) && $res[2]) {				ajax($res[0], 1, $res[2]);			}			ajax($res[0], 1);		} else {			ajax($res[0]);		}	}	public function rules()	{		$this->set_title('矿机工厂');		$des = db::table("poolgbw_shuoming")->where(["id" => 1])->find();		ajax($des, 1);	}}