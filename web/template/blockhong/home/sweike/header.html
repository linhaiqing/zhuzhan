{include file="public:top"}
<link rel="stylesheet" type="text/css" href="__CSS__/sweike/common.css">
<link rel="stylesheet" type="text/css" href="__CSS__/sweike/index.css">
<script src="__JS__/sweike/scroll.js"></script>
<script src="__EXT__/layer/laydate/laydate.js"></script>
<div class="all_mask_loginbox" id="step1" style="display: none;width:668px;top:166px;">
	<div class="login_title pl20">{#lang('立即发布一个任务')}</div>
	<form id="form-login" class="mask_wrap login-fb">
		<div class="login_text zin90">
			<div class="mask_wrap_title">{#lang('任务名称')}：</div>
			<input id="title" class="texts" type="text" style="width:308px;" maxlength="20">
		</div>
		<div class="login_text zin80">
			<div class="mask_wrap_title">{#lang('任务类型')}：</div>
			<select name="bank" id="renwu1" class="texts" style="width:148px;">
				<option value="0">{#lang('--选择任务--')}</option>
				<option value="">测试一级任务</option>
				<option value="">测试一级任务</option>
			</select> <select name="bank" id="renwu2" class="texts" style="width:148px;display:none">
			<option value="0">{#lang('--选择任务--')}</option>
			<option value="">测试一级任务</option>
			<option value="">测试一级任务</option>
		</select> <select name="bank" id="renwu3" class="texts" style="width:148px;display:none">
			<option value="a">{#lang('--选择任务--')}</option>
			<option value="">测试一级任务</option>
			<option value="">测试一级任务</option>
		</select>
		</div>
		<div class="login_text zin80">
			<div class="mask_wrap_title">{#lang('请输入任务描述')}：</div>
			<textarea id="content" cols="30" rows="10" style="border: 1px solid #C4C4C4;" maxlength="200" style="width:310px"></textarea>
		</div>
		<div class="login_text zin80">
			<div class="mask_wrap_title">{#lang('请输入截止日期')}：</div>
			<input id="endtime" class="texts" type="text" value="" onclick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})">
		</div>
		<div class="login_text zin80">
			<div class="mask_wrap_title">{#lang('请输入投稿地址')}：</div>
			<input id="adress" class="texts" type="text" value="">
		</div>
		<div class="login_text zin80">
			<div class="mask_wrap_title">{#lang('请输入酬劳')}：</div>
			<input id="price" class="texts" type="text" value="">
		</div>
		<div class="login_text zin80">
			<div class="mask_wrap_title">{#lang('请选择币种')}：</div>
			<select name="coin" id="coin" class="texts" style="width:148px;">
				<option value="0">{#lang('--选择币种--')}</option>
				<option value="">测试一级任务</option>
				<option value="">测试一级任务</option>
			</select>
		</div>
		<div class="login_text zin80">
			<div class="mask_wrap_title">{#lang('请输入交易密码')}：</div>
			<input id="paypassword" class="texts" type="password" value="">
		</div>
		<div class="login_button">
			<input type="button" class="btns2" value={#lang("立即添加")} onclick="bank_up();">
		</div>
	</form>
	<div class="mask_wrap_close " onclick="showB()"><i class="fa fa-close fa-2x move"></i></div>
</div>
<div id="step2" class="all_maskII" style="height: 0px;display: none;"></div>
<div class="ht10"></div>
<div class="wrapper">
	<div class="logo fl" style="float:left; position:relative;width: 266px;height: 50px;">
		{if $config['web_logo']} <a href="/"><img src="__UP__/{$config['web_logo']}" alt=""/></a> {else}
		<a href="/" class="xiaozhu-logo"> <i class="move-self move-logo2 move"></i> </a> {/if}
	</div>
	<div class="fl pt24 pl20" style="display:none">
		<div class="tel"></div>
		<div class="calltime">
			客服时间：9:00-22:00
		</div>
	</div>
	<div class="fl ">
		<div class="fl ttcen">
			<form method="get" class="top_search_form" action="{#url('sweike/lists')}">
				<div class="ttss">
					<div class="fl sssel">项 目</div>
					<div class="fl tskey">
						<input class="inputss_s" maxlength="30" value="" placeholder="请输入项目编号或标题" type="text" name="keyword">
					</div>
					<div class="fl tsbt">
						<input class="tsbt_search_btn" type="submit" value="搜索" style="color:#FFF;">
					</div>
					<input value="" style="display:none;" type="submit">
					<div class="clear"></div>
				</div>
			</form>
		</div>
		<div class="fl or">OR</div>
		<a class="fl fastfabu" href="javascript:void(0);" onclick="showA()">立即发布任务</a>
		<div class="clear"></div>
		<div class="hotsearch">
			<ul>
				{foreach $tjtype as $v}
				<li><a href="/sweike/lists/type1/{$v['id']}" target="_blank">{$v['type']}</a></li>
				{/foreach}
			</ul>
			<div class="clear"></div>
		</div>
	</div>
	<div class="clear"></div>
</div>
<div class="ht20"></div>
<div class="wrapper">
	<div class="fl mainmenu">
		全部分类
	</div>
	<div class="fl subnav">
		<ul>
			<li><a href="/sweike/index" title="首页">首页</a></li>
			<li><a href="/sweike/lists" title="需求大厅">需求大厅</a></li>
			<li><a href="/sweike/log" title="个人中心">个人中心</a></li>
		</ul>
		<div class="clear"></div>
	</div>
	<div class="clear"></div>
</div>
<div class="redline3"></div>
<div class="wrapper">
	<div class="fl mainbav" id="onlymainbav">
		{foreach $typelist1 as $v}
		<div class="menu nav_0" style="overflow:hidden">
			<div class="classname">
				{foreach $v['title'] as $val}
				<a href="/sweike/lists/type1/{$val['id']}" target="_blank">{$val['title']}</a>、 {/foreach}
			</div>
			<div class="subnav_border">
				<div class="subnav_1">
					<div class="subnav_1_top"></div>
					<div>
						{foreach $v['pid_list'] as $val}
						<div class="subnavclass" style="width: 645px;">
							<div class="subnav_title"><a href="/Mobile/" target="_blank">{$val['type']}</a></div>
							<div class="navclassitem">
								<div class="line_52"></div>
								<ul>
									{foreach $val['pid_list'] as $value}
									<li>
										<a class="searchtext red" href="/sweike/lists/type1/{$val['id']}/type2/{$value['id']}" target="_blank">{$value['type']}</a>
									</li>
									{/foreach}
								</ul>
							</div>
						</div>
						{/foreach}
						<div class="clear"></div>
					</div>
					<div class="subnavprovider" style="padding-top:25px;">
						<div class="subnav_title">推荐服务商</div>
						<div>
							<dl>
								<dt>
									<a href="/" target="_blank"><img src="__IMG__/sweike/move.png" title="武汉动说科技有限公司" alt="武汉动说科技有限公司"></a>
								</dt>
								<dd>
									<a href="/" target="_blank" title="武汉动说科技有限公司">武汉动说科技有限公司</a>
								</dd>
							</dl>
							<div class="clear"></div>
						</div>
					</div>
					<div class="subnav_1_bottom"></div>
				</div>
			</div>
		</div>
		{/foreach}
	</div>
</div>
<script>
	laydate({
		elem: '#endtime',
		format: 'YYYY-MM-DD hh:mm:ss', // 分隔符可以任意定义，该例子表示只显示年月
		festival: true, //显示节日
		choose: function (datas) { //选择日期完毕的回调
			alert('得到：' + datas);
		}
	});
</script>
<script>
	$('#trade_top').hover(function () {
		$('#trade_list').show();
	}, function () {
		$('#trade_list').hide();
	});
	$('#trade_list').hover(function () {
		$('#trade_list').show();
	}, function () {
		$('#trade_list').hide();
	});

	$.post("/ajax/top_coin_menu?t=" + Math.random(), function (data) {
		if (data) {
			var interText = doT.template($("#trade_list_tpl").text());
			$("#trade_list").html(interText(data));

			var $li = $('#trade-nav-tabs > li');
			var $ul = $('#trade-nav-body > dl');

			$li.mouseover(function () {
				var $this = $(this);
				var $t = $this.index();
				$li.removeClass();
				$this.addClass('current');
				$ul.css('display', 'none');
				$ul.eq($t).css('display', 'block');
			})
		}
	}, "json");

	$('#game_top').hover(function () {
		$('#game_list').show();
	}, function () {
		$('#game_list').hide();
	});
	$('#game_list').hover(function () {
		$('#game_list').show();
	}, function () {
		$('#game_list').hide();
	});


	$('#user_top').hover(function () {
		$('#mywallet_list').show();
	}, function () {
		$('#mywallet_list').hide();
	});
	$('#mywallet_list').hover(function () {
		$('#mywallet_list').show();
	}, function () {
		$('#mywallet_list').hide();
	});


	$('#theme_top').hover(function () {
		$('#theme_list').show();
	}, function () {
		$('#theme_list').hide();
	});
	$('#theme_list').hover(function () {
		$('#theme_list').show();
	}, function () {
		$('#theme_list').hide();
	});
	$(document).ready(function () {
		var theme = $.cookies.get("theme");
		if (theme) {
			$('#theme').attr("href", "__CSS__/" + theme + ".css");
		} else {

		}
	});
	function chose_theme(theme) {
		$.cookies.set("theme", theme);
		window.location.reload();
	}
	$('#lang_top').hover(function () {
		$('#lang_list').show();
	}, function () {
		$('#lang_list').hide();
	});
	$('#lang_list').hover(function () {
		$('#lang_list').show();
	}, function () {
		$('#lang_list').hide();
	});

	function chose_lang(lang) {
		$.cookies.set("lang", lang);
		window.location.reload();
	}


	function expect() {
		layer.msg('暂未上线，敬请期待!', {icon: 6});
	}

	$('#moban_top').hover(function () {
		$('#moban_list').show();
	}, function () {
		$('#moban_list').hide();
	});
	$('#moban_list').hover(function () {
		$('#moban_list').show();
	}, function () {
		$('#moban_list').hide();
	});
</script>
<script>
	$(document).ready(function () {
		$("#example1").posfixed({});
	});
</script>
<script>
	$(function () {
		var height = $(document).height();
		if (height < 1000) {
			height = 1000;
		}
		$('#step2').height(height);
	});
	function showA() {
		$("#step1").show();
		$("#step2").show();
	}

	function showB() {
		$("#step1").hide();
		$("#step2").hide();
	}


	var levelOneIndex;
	var levelTwoIndex;
	var levelThreeIndex;
	$.post('{#url("sweike/json")}', function (data) {
		var option0 = '';
		var option1 = '';
		option0 += "<option value='' >{#lang('--选择币种--')}</option>";
		option1 += "<option value='a'>{#lang('--选择任务--')}</option>";
		//选择币种
		$.each(data.url['coinlist'], function (index, item) {
			option0 += '<option value="" id="' + item.id + '">' + item.title + '</option>';
		})
		$('#coin').html(option0);


		$.each(data.url['type'], function (index, item) {
			option1 += '<option value="' + index + '" >' + item.type + '</option>';
		});
		$('#renwu1').html(option1);


		$('#renwu1').change(function () {
			var idx = $(this).val();
			if (idx == 'a') {
				$('#renwu2,#renwu3').hide();
			} else {
				levelOneIndex = idx;
				option2 = '';
				option2 += "<option value='a'>{#lang('--选择任务--')}</option>";

				$.each(data.url['type'][idx]['pid_list'], function (index1, item1) {
					option2 += '<option value="' + index1 + '" >' + item1.type + '</option>';
				});

				$('#renwu2').html(option2).show();

			}
			var hide2 = $('#renwu2').val();

			if (hide2 == 'a') {
				$('#renwu3').hide();
			}
		});


		$('#renwu2').change(function () {
			option3 = '';
			var idx = $(this).val();

			$('#renwu3').hide();

			levelTwoIndex = idx;
			if (idx != '--选择任务--') {
				var typeData = data.url['type'];
				var thirdObject = typeData[levelOneIndex].pid_list[levelTwoIndex];

				if (typeof thirdObject.pid_list != 'undefined') {
					option3 += "<option value='a'>{#lang('--选择任务--')}</option>";
					$.each(thirdObject.pid_list, function (index, element) {
						option3 += '<option value="' + element.id + '" id="' + element.id + '">' + element.type + '</option>';
					})

				} else {
					$('#renwu3').hide();
				}

				$('#renwu3').html(option3);
				$('#renwu3').show();
			} else {
				$('#renwu3').hide();
			}
		});
	}, 'json');

	function bank_up() {

		var type = $('#renwu3 option:selected').attr('value');
		var price = $('#price').val();
		var price_type = $('#coin option:selected').attr('id');
		var title = $('#title').val();
		var content = $('#content').val();
		var endtime = $('#endtime').val();
		var adress = $('#adress').val();
		var paypassword = $('#paypassword').val();
		if (price == "" || price == null) {
			layer.tips("{#lang('请输入酬劳金额')}", '#price', {tips: 2});
			return false;
		}
		if (price_type == "" || price_type == null) {
			layer.tips("{#lang('请选择币种')}", '#coin', {tips: 2});
			return false;
		}
		if (title == "" || title == null) {
			layer.tips("{#lang('请输入任务标题')}", '#title', {tips: 2});
			return false;
		}
		if (content == "" || content == null) {
			layer.tips("{#lang('请输入任务内容')}", '#coin', {tips: 2});
			return false;
		}
		if (endtime == "" || endtime == null) {
			layer.tips("{#lang('请输入任务截止时间')}", '#endtime', {tips: 2});
			return false;
		}
		if (adress == "" || adress == null) {
			layer.tips("{#lang('请输入投稿地址')}", '#adress', {tips: 2});
			return false;
		}
		if (paypassword == "" || paypassword == null) {
			layer.tips("{#lang('请输入交易密码')}", '#paypassword', {tips: 2});
			return false;
		}
		$.post("{#url('/sweike/up')}", {
			type: type,
			price: price,
			price_type: price_type,
			title: title,
			content: content,
			endtime: endtime,
			adress: adress,
			paypassword:paypassword
		}, function (data) {
			if (data.status == 1) {
				layer.msg(data.info, {icon: 1});
				location.reload();
			} else {
				layer.msg(data.info, {icon: 2});
				if (data.url) {
					window.location = data.url;
				}
			}
		}, 'json');
	}


	$('.menu').hover(function () {
		$(this).children('.subnav_border').toggle();
	});
</script>
