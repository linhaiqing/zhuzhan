<!DOCTYPE html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="renderer" content="webkit">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>{$config['web_title']}</title>
    <meta name="Keywords" content="{$config['web_keywords']}">
    <meta name="Description" content="{$config['web_description']}">
    <meta name="author" content="movesay.com">
    <meta name="coprright" content="movesay.com">
    <link rel="shortcut icon" href="/favicon.ico"/>
    <link rel="stylesheet" href="__EXT__/Font-Awesome-4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="__CSS__/style.css" id="theme"/>
    <link rel="stylesheet" href="__CSS__/common.css"/>
    <link rel="stylesheet" href='__CSS__/chart.css'/>
</head>
<style>
	.all_coin_list,.all_coin_box ul{width:auto}
	.all_coin_box{width:auto}
	.all_coin_box .group{width:220px}
</style>
<body>
    <div id="loading"></div>
    <div class="main-windows">
        <div class="chart_header">
            <div style="position: relative;margin-left: 20px;width:auto;min-width:200px;float: left;">

	            {if $config['trade_logo']}
	            <a href="/trade"><img src="__UP__/{$config['trade_logo']}" style="position: absolute;left: 0em;width: 200px;height: 50px;top:5px;"/></a>
	            {else}
	            <a href="/trade" class="xiaozhu-logo">
		            <i class="move-self move-logo2 move" style="top:6px"></i>
	            </a>
	            {/if}

            </div>
            <div style="position: relative;margin-left: 20px;width: 200px;">
                <div class="all_coin_price">
                    <div class="all_coin_show">
                        <a href="">
                            {if $xnb}
                                <img src="__UP__/{$coin_list[$xnb]['img']}" style="float: left; width: 40px; height: 40px; margin-right: 5px;">
                            {/if}
                            <span>{$market_list[$market]['title']}</span>
	                         <i class="fa fa-caret-down" style="margin-top:17px;width:auto;height:auto;color:#de211d"></i>
                        </a>
                    </div>
                    <div class="all_coin_list" style="display: none;">
                        <div class="all_coin_box">
	                        {foreach $menu as $v}
	                        <div data-v-454fa2dd="" class="group">
		                        <div data-v-454fa2dd="" class="title">{#lang($v['title'])}</div>
		                        <ul data-v-454fa2dd="" class="trade_hover_ul">
			                        {foreach $v['data'] as $kk=>$vv}
			                        <li data-v-454fa2dd="" class="list">
				                        <div data-v-454fa2dd="" class="img_box lay">
					                        <img data-v-454fa2dd="" src="__UP__/{$vv['img']}">
				                        </div>
				                        <a data-v-454fa2dd="" href="{#url('/trade/chart/market/'.$kk)}">
					                        <div data-v-454fa2dd="" class="txt lay">{#lang($vv['title'])}</div>
				                        </a>
			                        </li>
			                        {/foreach}
		                        </ul>
	                        </div>
	                        {/foreach}
                        </div>
                    </div>
                </div>
            </div>
            <div style="position: relative;">
                <span style="line-height: 60px;font-size: 36px;color: #49b671;" id="market_new_price">--</span>
            </div>
            <div class="chart_header_info" style="position: relative;left:90px;margin-left: 20px;">
                <div class="table">
                    <dl class="dl" style="    height: 30px;line-height: 30px;font-size: 16px;">
                        <dt style="color:#e55600" id="market_max_price">--</dt>
                        <dt style="color: #690;"  id="market_min_price">--</dt>
                        <dt id="market_buy_price">--</dt>
                        <dt id="market_sell_price">--</dt>
                        <dt id="market_volume">--</dt>
                        <dt id="market_change">--</dt>
                    </dl>
                    <dl class="dl">
                        <dd>{#lang('最高价')}</dd>
                        <dd>{#lang('最低价')}</dd>
                        <dd>{#lang('买一价')}</dd>
                        <dd>{#lang('卖一价')}</dd>
                        <dd>{#lang('成交量')}</dd>
                        <dd>{#lang('日涨跌')}</dd>
                    </dl>
                </div>
            </div>
            <div class="header_menu">
                {if $userid}
                    <span><a href="/finan.html" target="_blank">{$user['username']}</a></span>
                    <span>|</span>
                    <span><a href="/trade/index/market/{$market}" target="_blank">{#lang('返回交易')}</a></span>
                {else}
                    <span><a href="javascript:loginpop();"  target="_blank">{#lang('登录')}</a></span>
                    <span>|</span>
                    <span><a href="/reg" target="_blank">{#lang('注册')}</a></span>
                {/if}
            </div>
        </div>
        <div class="main_chart">
            <div class="line-lift-block" >
                <div class="main" style="width:auto;">
                   <!-- <iframe id="market_chart" src="/trade/specialty?market={$market}"></iframe>-->
                    <iframe id="market_chart" src="/trade/kline_h?market={$market}"></iframe>



                </div>
                <div class="chart_footer" style="display:none">
                    <ul>

                        <span>© 2013-2017 {$config['web_title']}</span>
                        <span><li>{$config['web_icp']}</li></span>
                    </ul>

                </div>

            </div>
            <div class="line-right-block">
                <div class="left_block">
                    <div class="left_block_sub2">
                        <table class="sell_block">
                            <thead>
                            <tr>
                                <th width="50">{#lang('卖出')}</th>
                                <th width="80">{#lang('价格')}</th>
                                <th width="120">{#lang('数量')}</th>
                            </tr>
                            </thead>
                        </table>
                        <div class="sell_block_body">
                            <table>
                                <tbody id="marketselllist"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="left_block_sub1">
                        <table class="buy_block">
                            <thead>
                            <tr>
                                <th width="50">{#lang('最新价格')}</th>
                                <th width="80" id="table_newPrice">--</th>
                                <th width="120">{#lang('数量')}</th>
                            </tr>
                            </thead>
                        </table>

                        <div class="buy_block_body">
                            <table class="">
                                <tbody id="marketbuylist"></tbody>
                            </table>
                        </div>
                    </div>

                </div>


                <div class="right_block">
                    <table class="log_block">
                        <thead>
                        <tr>
                            <th width="70">{#lang('时间')}</th>
                            <th width="70">{#lang('价格')}</th>
                            <th width="100">{#lang('数量')}</th>
                        </tr>
                        </thead>
                    </table>
                    <div class="log_block_body">
                        <table>
                            <tbody id="marketorderlist"></tbody>
                        </table>
                    </div>
                </div>
            </div>
	        <div class="jiaoyi">
		        <ul>
			        <li class="active">{#lang('委托')}</li>
			        <li>{#lang('记录')}</li>
			        <div class="open" zt="0">↑</div>
		        </ul>

		        <div class="clear"></div>
		        <div class="yincang over_auto">
			        {if $user}
			        <div class="over_hidden left">

				        <table class="Transaction no_border_right no_border_left_right">
					        <thead>
					        <tr>
						        <th width="180">{#lang('时间')}</th>
						        <th width="80">{#lang('买/卖')}</th>
						        <th>{#lang('价格')}</th>
						        <th>{#lang('数量')}</th>
						        <th>{#lang('已成交')}</th>
						        <th>{#lang('总额')}</th>
						        <th width="80">{#lang('操作')}</th>
					        </tr>
					        </thead>
					        <tbody id="entrustlist" class="no-border-left-right">
					        </tbody>
				        </table>
			        </div>
			        <div class="over_hidden left" style="display:none;">
				        <div class="over_auto">
					        <table class="Transaction  no_border_right no_border_left_right">
						        <thead>
						        <tr>
							        <th width="180">{#lang('时间')}</th>
							        <th width="80">{#lang('买/卖')}</th>
							        <th width="180">{#lang('成交价')}</th>
							        <th width="200">{#lang('成交量')}</th>
							        <th><span style="padding-right: 30px;">{#lang('总额')}</span></th>
						        </tr>
						        </thead>
					        </table>
				        </div>
				        <div class="over_auto" style=" max-height:235px; overflow-x: hidden; overflow-y: auto;">
					        <table class="Transaction  no_border_right no_border_left_right">
						        <tbody id="orderlist" class="no-border-left-right">
						        </tbody>
					        </table>
				        </div>
			        </div>
			        <div class="fast_tr clear over_auto" style="height: auto;;">
				        <div class="bk-cell item">
					        <div class="bk-buy-form">
						        <form role="form" id="buyForm" class="form-horizontal" method="post" action="" autocomplete="off">
							        <input type="hidden" name="buyType" id="buyType" value="0">
							        <input type="hidden" name="moneyType" id="moneyType" value="0">
							        <input type="hidden" name="coinType" id="coinType" value="1">
							        <div class="form-group has-feedback" style="padding-top:8px;">
								        <label class="control-label" style="position:static;">{#lang('最佳买价')}：<b id="buy_best_price" class="text-primary">--</b> CNY/{#strtoupper($xnb)}</label>
								        <label class="control-label" style="position:static;">{#lang('可买')}：<b id="buy_max" class="text-gray">----</b>&nbsp;&nbsp; {#strtoupper($xnb)}</label>
								        <span style="display:none" id="my_rmb"></span>
							        </div>
							        <div id="buyDefaultForm">
								        <div class="form-group has-feedback">
									        <div class="input-group">
										        <input type="text" class="form-control form-second" id="buy_price" name="buyUnitPrice" placeholder="买入{#strtoupper($xnb)}价格">
									        </div>
								        </div>
								        <div class="form-group has-feedback">
									        <div class="input-group">
										        <input type="text" class="form-control form-second" id="buy_num" name="buyNumber" placeholder="买入{#strtoupper($xnb)}数量">
									        </div>
								        </div>
								        <div class="form-group has-feedback">
									        <div class="slider_wrap">
										        <div id="ratio_num_buy" class="ratio">0%</div>
										        <div class="sliderbox">
											        <div id="slider_buy" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all">
												        <div class="ui-slider-range ui-widget-header ui-slider-range-min"></div>
												        <a data_slide="buy" class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="left: 0%;"></a>
												        <div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-min" style="width: 0%;"></div>
												        <div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-min" style="width: 0%;"></div></div>
										        </div>
									        </div>
								        </div>
								        <div class="form-group has-feedback">
									        <label class="control-label" for="buy_mum" style="position:static;">{#lang('预计交易额')}：<b class="text-primary" id="buy_mum">0.00</b> CNY</label>

								        </div>
								        <div class="form-group has-feedback">
									        <label class="control-label" for="buy_mum" style="position:static;">{#lang('手续费')}：<b class="text-primary" >{$market_list[$market]['fee_buy']}%</b></label>

								        </div>
								        <div class="form-group has-feedback">
									        <div class="input-group">
										        <input type="password" id="buy_paypassword" class="form-control form-second"  name="paypassword" placeholder="{#lang('请输入交易密码')}">
									        </div>
								        </div>
								        <div class="form-group">
									        <button id="buyBtn" type="button" class="btn btn-primary btn-block btn-hg" onclick="tradeadd_buy()">
										        <i class="bk-ico buycart"></i>{#lang('立即买入')}
									        </button>
								        </div>
							        </div>
						        </form>
					        </div>
				        </div>

				        <div class="bk-cell item">
						        <div class="bk-sell-form">
							        <form role="form" id="sellForm" class="form-horizontal" method="post" action="" autocomplete="off">
								        <div class="form-group has-feedback" style="padding-top:8px;">
									        <label class="control-label" style="position:static;">{#lang('最佳卖价')}：<b id="sell_best_price" class="text-second">--</b> CNY/{#strtoupper($xnb)}</label>
									        <label class="control-label" style="position:static;">{#lang('可卖')}：<b id="sell_max" class="text-gray">----</b> &nbsp;&nbsp;{#strtoupper($xnb)}</label>
									        <span style="display:none" id="my_xnb"></span>
								        </div>
								        <div id="sellDefaultForm">
									        <div class="form-group has-feedback">
										        <div class="input-group">
											        <input type="text" class="form-control form-second" id="sell_price" name="sell_price" placeholder="卖出{#strtoupper($xnb)}币">
										        </div>
									        </div>
									        <div class="form-group has-feedback">
										        <div class="input-group">
											        <input type="text" class="form-control form-second" id="sell_num" name="sell_num" placeholder="卖出{#strtoupper($xnb)}数量">
										        </div>
									        </div>
									        <div class="form-group has-feedback">
										        <div class="slider_wrap">
											        <div id="ratio_num_sell" class="ratio">0%</div>
											        <div class="sliderbox">
												        <div id="slider_sell" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all">
													        <div class="ui-slider-range ui-widget-header ui-slider-range-min"></div>
													        <a data_slide="sell" class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="left: 0%;"></a>
													        <div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-min" style="width: 0%;"></div>
													        <div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-min" style="width: 0%;"></div></div>
											        </div>
										        </div>
									        </div>
									        <div class="form-group has-feedback">
										        <label class="control-label" for="sell_mum" style="position:static;">{#lang('预计交易额')}：<b class="text-primary" id="sell_mum">0.00</b> CNY</label>

									        </div>
									        <div class="form-group has-feedback">
										        <label class="control-label" for="sell_mum" style="position:static;">{#lang('手续费')}：<b class="text-primary" >{$market_list[$market]['fee_sell']}%</b></label>

									        </div>

									        <div class="form-group has-feedback">
										        <div class="input-group">
											        <input type="password" id="sell_paypassword" class="form-control form-second"  name="paypassword" placeholder="{#lang('请输入交易密码')}">
										        </div>
									        </div>

									        <div class="form-group">
										        <button id="sellBtn" type="button" class="btn btn-second btn-block btn-hg" onclick="tradeadd_sell()" >
											        <i class="bk-ico sellhand"></i>{#lang('立即卖出')}
										        </button>
									        </div>
								        </div>
							        </form>
						        </div>
					        </div>
				        </div>
			        {else}
			        <p style="font-size:25px;padding-top: 100px;text-align: center;">{#lang('您还没有登录，请')}<a class="buy" href="javascript:loginpop();">{#lang('登录')}</a>{#lang('或')}<a class="green" href="{#url('/reg')}">{#lang('注册')}</a>{#lang('后再操作')}</p>
			        {/if}
		        </div>
	        </div>
        </div>
    </div>

</body>
<script type="text/javascript" src="__EXT__/jquery/jquery.min.js"></script>
<script type="text/javascript" src="__EXT__/jquery/jquery.cookies.2.2.0.js"></script>
<script type="text/javascript" src="__EXT__/layer/layer.js"></script>
<script type="text/javascript" src="__EXT__/posfixed/posfixed.js"></script>
<script type="text/javascript" src="__EXT__/doT/doT.min.js"></script>
<script type="text/javascript" src="__EXT__/jquery/jquery-ui.js"></script>
<script>

	// 自动填价格
	function autotrust(_this, type, cq) {


		if (type == 'sell') {

			$('#buy_price').val($(_this).children().eq(cq).html()).css({'color': '#fff', 'font_size': '14px'});
			if ($("#my_rmb").html() > 0) {
				$("#buy_max").html(toNum(($("#my_rmb").html() / $('#buy_price').val()), 6));
			}
			if ($('#buy_num').val()) {
				$("#buy_mum").html(($('#buy_num').val() * $('#buy_price').val()).toFixed(8) * 1);
			}
		}

		if (type == 'buy') {

			$('#sell_price').val($(_this).children().eq(cq).html()).css({'color': '#fff', 'fontSize': '14px'});
			if ($("#my_xnb").html() > 0) {
				$("#sell_max").html($("#my_xnb").html());
			}
			if ($('#sell_num').val()) {
				$("#sell_mum").html(($('#sell_num').val() * $('#sell_price').val()).toFixed(8) * 1);
			}
		}

	}



	screen=0;
	$('.jiaoyi ul li').click(function(){
		var idx=$(this).index();
		var a=$('.yincang').children().eq(idx).show().siblings('.left').hide();

		$(this).addClass('active').siblings().removeClass('active');
		$('.open').attr({'zt':1}).html('↓');
		screen=0;
		autoHeight(300);


	});
	$('.open').click(function(){
		screen=0;
		var zt=$(this).attr('zt');
		if(zt == 0){

			autoHeight(300);
			$(this).attr({'zt':1});
			$(this).html('↓');
		}else{
			$(this).attr({'zt':0});
			$(this).html('↑');
			autoHeight();
		}

});




	function get_json_new() {
		$.getJSON("/trade/chart_json/market/{$market}/t=" + Math.random(), function (data) {
			if (data) {
				if (data['menu']) {
					trade_menu(data['menu']);
				}
				if (data['top']) {
					trade_top(data['top']);
				}
				if (data['buy']) {
					trade_buy(data['buy']);
				}
				if (data['order']) {
					$('#entrust_over').show();
					trade_order(data['order']);
				} else {
					$('#entrust_over').hide();
				}

				if (data['sell']) {
					trade_sell(data['sell']);
				}
				if (data['log']) {
					trade_log(data['log']);
					trade_trades(data['trades']);
				}
			}

		});
	}

	// 买入/卖出 比例
	function slider() {
		var type  = ['sell', 'buy'];
		var round = "{$coin_list[$xnb]['round']}";
		var $user="{$user['id']}";

		for (var i in type) {
			$("#slider_" + type[i]).slider({
				value: 0, min: 0, max: 100, step: 10, range: "min", slide: function (a, t) {

					var type = $(t.handle).attr('data_slide');
					var e    = parseFloat($("#" + type + '_max').text());
					if (isNaN(e)) e = 0;
					$("#" + type + ' .ui-slider-handle').addClass('ui-state-focus ui-state-active');
					$("#" + type + "_num").val((e / 100 * t.value).toFixed(8 - parseInt(round)));
					$("#ratio_num_" + type).text(t.value + "%");
					if ($('#' + type + '_price').val()) {
						$("#" + type + "_mum").html(((e / 100 * t.value * $('#' + type + '_price').val())).toFixed(8));
					}
				}
			})
		}
	}

	slider();


	$('#buy_price,#buy_num,#sell_price,#sell_num').css("ime-mode", "disabled").bind('keyup change', function () {
		var buyprice  = parseFloat($('#buy_price').val());
		var buynum    = parseFloat($('#buy_num').val());
		var sellprice = parseFloat($('#sell_price').val());
		var sellnum   = parseFloat($('#sell_num').val());
		var buymum    = buyprice * buynum;
		var sellmum   = sellprice * sellnum;
		var myrmb     = $("#my_rmb").html();
		var myxnb     = $("#my_xnb").html();
		var buykenum  = 0;
		var sellkenum = 0;
		var buyfee    = parseFloat("{$market_list[$market]['fee_buy']}");
		var sellfee   = parseFloat("{$market_list[$market]['fee_sell']}");


		if (buyfee > 0) {
			buymum = parseFloat(buymum / 100 * (100 + buyfee));
		}
		if (sellfee > 0) {
			sellmum = parseFloat(sellmum / 100 * (100 - sellfee));
		}


		var round = parseInt("{$coin_list[$xnb]['round']}");
		if (myrmb > 0) {
			buykenum = myrmb / buyprice;
		}

		if (myxnb > 0) {

			sellkenum = myxnb;

		}

		if (buyprice != null && buyprice.toString().split(".") != null && buyprice.toString().split(".")[1] != null) {
			if (buyprice.toString().split('.')[1].length > round) {
				$('#buy_price').val(buyprice.toFixed(round));
			}
		}

		if (buynum != null && buynum.toString().split(".") != null && buynum.toString().split(".")[1] != null) {
			if (buynum.toString().split('.')[1].length > (8 - round)) {
				$('#buy_num').val(toNum(buynum, (8 - round)));
			}
		}
		if (sellprice != null && sellprice.toString().split(".") != null && sellprice.toString().split(".")[1] != null) {
			if (sellprice.toString().split('.')[1].length > round) {
				$('#sell_price').val(sellprice.toFixed(round));
			}
		}
		if (sellnum != null && sellnum.toString().split(".") != null && sellnum.toString().split(".")[1] != null) {
			if (sellnum.toString().split('.')[1].length > (8 - round)) {
				$('#sell_num').val(toNum(sellnum, (8 - round)));
			}
		}
		if (buymum != null && buymum > 0) {
			$('#buy_mum').html(buymum.toFixed(8) * 1);
		}
		if (sellmum != null && sellmum > 0) {
			$('#sell_mum').html(sellmum.toFixed(8) * 1);
		}
		if (buykenum != null && buykenum > 0 && buykenum != 'Infinity') {
			$('#buy_max').html(toNum(buykenum, (8 - round)));
		}

		if (sellkenum != null && sellkenum > 0 && sellkenum != 'Infinity') {

			$('#sell_max').html(sellkenum);
		}
	}).bind("paste", function () {
		return false;
	}).bind("blur", function () {
		if (this.value.slice(-1) == ".") {
			this.value = this.value.slice(0, this.value.length - 1);
		}
	}).bind("keypress", function (e) {
		var code = (e.keyCode ? e.keyCode : e.which); //兼容火狐 IE
		if (this.value.indexOf(".") == -1) {
			return (code >= 48 && code <= 57) || (code == 46);
		} else {
			return code >= 48 && code <= 57
		}
	});

	function toNum(num, round) {
		return Math.round(num * Math.pow(10, round) - 1) / Math.pow(10, round);
	}
	function trade_finance(data) {


		if (data[0]) {
			data[0]=data[0].toFixed(2);
			$("#my_rmb").html(data[0]);

		} else {
			$("#my_rmb").html('0.00');
		}

		if (data[1]) {
			$("#my_rmbd").html(data[1]);
		} else {
			$("#my_rmbd").html('0.00');
		}

		if (data[2]) {
			$("#my_xnb").html(data[2]);
		} else {
			$("#my_xnb").html('0.00');
		}

		if (data[3]) {
			$("#my_xnbd").html(data[3]);
		} else {
			$("#my_xnbd").html('0.00');
		}

		if (data[4]) {
			$('#my_finance').html(data[4]);
		} else {
			$("#my_finance").html('0.00');
		}

	}

	function get_json_trade() {

		$.getJSON("/trade/index_json/market/{$market}?t=" + Math.random(), function (data) {

			if (data) {
				if (data['menu']) {
					trade_menu(data['menu']);
				}
				if (data['top']) {
					trade_top(data['top']);
				}
				if (data['depth']) {
				trade_depth(data['depth']);// 没用
				}
				if (data['order']) {
					$('#entrust_over').show();
					trade_order(data['order']);
				} else {
					$('#entrust_over').hide();
				}
				if (data['trades']) {
					trade_trades(data['trades']);
				}
				if (data['finance']) {
					trade_finance(data['finance']);
				}
			}

			setTimeout('get_json_trade()', 5000);
		});
	}
		//get_json_trade();




	function trade_order(data) {
		var list = '';

		var cont = data.length;

		for (i = 0; i < cont; i++) {

			if (data[i][1] == 1) {
				list += '<tr title="{#lang(以这个价格卖出)}" onclick="autotrust(this,\'buy\',2)"><td class="buy" >' + data[i][0] + '</td>' +
						'<td class="buy">' + '{#lang("买")}' + '</td>' +
						'<td class="buy">' + data[i][2] + '</td>' +
						'<td class="buy">' + data[i][3] + '</td>' +
						'<td class="buy" >' + data[i][4] + '</td>' +
						'<td class="buy">' + (data[i][2] * data[i][3]).toFixed(8) + '</td>' +
						'<td><a class="move" id="' + data[i][5] + '" onclick="cancelaa(\'' + data[i][5] + '\')" href="javascript:void(0);">{#lang("撤销")}</a></td>' +
						'</tr>';
			} else {
				list += '<tr title="{#lang(以这个价格买入)}" onclick="autotrust(this,\'sell\',2)">' +
						'<td class="sell" >' + data[i][0] + '</td><td class="sell" >{#lang("卖")}</td>' +
						'<td class="sell" >' + data[i][2] + '</td><td class="sell">' + data[i][3] + '</td>' +
						'<td class="sell" >' + data[i][4] + '</td><td class="sell">' + (data[i][2] * data[i][3]).toFixed(8) + '</td>' +
						'<td><a class="move" id="' + data[i][5] + '" onclick="cancelaa(\'' + data[i][5] + '\')" href="javascript:void(0);">{#lang("撤销")}</a></td></tr>';
			}

		}
		if (cont >= 6) {
			list += '<tr><td style="text-align:center;" colspan="7"><a href="/finan/trades" class="move">{#lang("更多委托信息")}</a>&nbsp;&nbsp;</td></tr>;'
		}

		$('#entrustlist').html(list);
		if (list) {
			$('.move_weituo').show();
		}

	}
	function trade_trades(data) {
		var list = '';
		for (var i in data) {
			if (data[i][1] == 1) {
				list += '<tr title="{#lang(以这个价格卖出)}" onclick="autotrust(this,\'buy\',2)"><td class="buy"   width="180">' + formatDateII(data[i][0]) + '</td><td class="buy"   width="80">{#lang("买")}</td><td class="buy"   width="200">' + data[i][2] + '</td><td class="buy"  width="200">' + data[i][3] + '</td><td class="buy">' + data[i][4] + '</td></tr>';
			} else {
				list += '<tr title="{#lang(以这个价格买入)}" onclick="autotrust(this,\'sell\',2)"><td class="sell"   width="180">' + formatDateII(data[i][0]) + '</td><td class="sell"   width="80">{#lang("卖")}</td><td class="sell"   width="200">' + data[i][2] + '</td><td class="sell"  width="200">' + data[i][3] + '</td><td class="sell">' + data[i][4] + '</td></tr>';
			}
		}
		$("#orderlist").html(list);
	}

	function trade_depth(data) {
		var list = '';
		if (data['s']) {
			if (data['s'] != 'no') {

				if (data['s']) {

					var chang= data['s'].length;
					if (chang > 10) {
						chang = 10;
					}
					var sellk = data['s'].length;
					for (i = 0; i < data['s'].length; i++) {
						list += '<dl title="{#lang(以这个价格买入)}" style="cursor: pointer;" onclick="autotrust(this,\'sell\',1)">' +
								'<dt class="sell"  style="width: 40px;padding-left: 5px;">{#lang("卖")}' + (sellk - i) + '</dt>' +
								'<dd class="sell"  style="width: 80px;text-align: right;">' + data['s'][i][0] + '</dd>' +
								'<dd class="sell"  style="width: 110px;text-align: right;">' + data['s'][i][1] + '</dd>' +
								'<dd class="sell"  style="width: 120px;text-align: right;">' + (data['s'][i][0] * data['s'][i][1]).toFixed(8) + '</dd>' +
								'</dl>';
					}
				}
			}


		}
		$("#selllist").html(list);
		list = '';
		if (data['b']) {
			if (data['b'] != 'no') {
				var i = 0;
				var chang;

				chang = data['b'].length;
				if (chang > 10) {
					chang = 10;
				}

				for (i = 0; i < chang; i++) {
					list += '<dl title="{#lang(以这个价格卖出)}" style="cursor: pointer;" onclick="autotrust(this,\'buy\',1)">' +
							'<dt class="buy"  style="width: 40px;padding-left: 5px;">{#lang("买")}' + (i + 1) + '</dt>' +
							'<dd class="buy"  style="width: 80px;text-align: right;">' + data['b'][i][0] + '</dd>' +
							'<dd class="buy"  style="width: 110px;text-align: right;">' + data['b'][i][1] + '</dd>' +
							'<dd class="buy"  style="width: 120px;text-align: right;">' + (data['b'][i][0] * data['b'][i][1]).toFixed(8) + '</dd>' +
							'</dl>';
				}
			}


		}
		$("#buylist").html(list);

	}

	function layertpwd() {
		var html = '<div id="all_mask" class="all_mask"></div><div id="tpwd" class="all_mask_loginbox">' +
				'<div class="login_title pl20">{#lang(交易密码输入设置)}</div><form id="tpwdsetting" class="set_verify" style="padding-left: 50px;">' +
				'<ul class="tpwd"><li><label for="only"><input type="radio" id="only" value="1" name="aaatpwdsetting"> {#lang('
		每次登录只输入一次交易密码
		')} </label></li><li>' +
		'<label for="every"><input type="radio" checked id="every" value="2" name="aaatpwdsetting"> {#lang('
		每笔交易都输入交易密码
		')}</label></li><li><label for="none">' +
		'<input type="radio" id="none" name="aaatpwdsetting" value="3"> {#lang('
		每次交易都不需要输入交易密码
		')}</label></li><li><input type="password" id="aaapaypassword" name="paypassword" placeholder="{#lang(请输入交易密码)}" class="texts"/><a href="/findpwd/paypassword" class="move ml5">{#lang('
		忘记
		')}?</a>' +
		'</li></ul><div class="save_verify"><input type="button"class="btns2" value="{#lang(保存)}" onclick="tpwdsettingaa()" /></div><div class="mask_wrap_close" id="pwd_close"><i class="fa fa-times fz_20 move" aria-hidden="true"></i></div></form></div>';
		$('body').append(html);
		$('#tpwd').css('top', ($(window).height() / 2) - (265 / 2) + $(document).scrollTop());
		$('.all_mask').css({'height': $(document).height()});
		$('#pwd_close').click(function () {
			$('#tpwd').remove();
			$('#all_mask').remove();
			$('#all_mask').remove();
		})


		$.get('/trade/tpwdsetting', function (d) {
			if (d == 1) {
				$('#only').prop('checked', true);
			}
			if (d == 2) {
				$('#every').prop('checked', true);
			}
			if (d == 3) {
				$('#none').prop('checked', true);
			}
		})
	}

	//保存交易密码设置
	function tpwdsettingaa() {
		var paypassword = $("#aaapaypassword").val();
		var tpwdsetting = $("input[name='aaatpwdsetting']:checked").val();
		if (paypassword == "" || paypassword == null) {
			layer.tips('{#lang("请输入交易密码")}', '#paypassword', {tips: 3});
			return false;
		}
		if (tpwdsetting == "" || tpwdsetting == null) {
			layer.tips('{#lang("请输入选择一个")}', '#tpwdsetting', {tips: 3});
			return false;
		}
		$.post('/trade/uptpwdsetting', {paypassword: paypassword, tpwdsetting: tpwdsetting}, function (d) {
			if (d.status == 1) {
				layer.msg('{#lang("设置成功")}', {icon: 1});
				window.location.reload();
			} else {
				layer.msg(d.info, {icon: 2});
			}

		}, 'json');
	}

	//撤销
	function cancelaa(id) {
		$.post("{#url('trade/chexiao')}", {id: id}, function (data) {
			if (data.status == 1) {
				layer.msg(data.info, {icon: 1});
			} else {
				layer.msg(data.info, {icon: 2});
			}
		}, 'json');
	}
	var trans_lock = 0;
	function tradeadd_buy() {

		if (trans_lock) {
			layer.msg('{#lang("不要重复提交")}', {icon: 2});
			return;
		}
		trans_lock = 1;

		var price       = parseFloat($('#buy_price').val());
		var num         = parseFloat($('#buy-num').val());
		var paypassword = $('#buy_paypassword').val();
		if (price == "" || price == null) {
			layer.tips('{#lang("请输入内容")}', '#buy_price', {tips: 3});
			return false;
		}
		if (num == "" || num == null) {
			layer.tips('{#lang("请输入内容")}', '#buy_num', {tips: 3});
			return false;
		}

		//加载层-风格3
		layer.load(2);

		//此处演示关闭
		setTimeout(function () {
			layer.closeAll('loading');
			trans_lock = 0;
		}, 10000);

		var goole = "{$goole}";
		if (goole == 1) {
			layer.config({
				extend: 'extend/layer.ext.js'
			});
			layer.ready(function () {
				//默认prompt
				layer.prompt({
					title: '{#lang("输入谷歌验证码，并确认")}',
					formType: 1
				}, function (val) {
					if (val) {
						//需要执行的方法

						$.post("{#url('trade/up')}", {
							price: $('#buy_price').val(),
							num: $('#buy_num').val(),
							paypassword: $('#buy_paypassword').val(),
							market: "{$market}",
							type: 1,
							goole: val,
						}, function (data) {
							layer.closeAll('loading');
							trans_lock = 0;
							if (data.status == 1) {
								get_json_new();
								//$("#buy_price").val('');
								$("#buy_num").val('');
								//$("#sell_price").val('');
								$("#sell_num").val('');
								layer.msg(data.info, {icon: 1});

							} else {
								layer.msg(data.info, {icon: 2});
							}
						}, 'json');


					}
					;
				});
			});
		} else {
			$.post("{#url('trade/up')}", {
				price: $('#buy_price').val(),
				num: $('#buy_num').val(),
				paypassword: $('#buy_paypassword').val(),
				market: "{$market}",
				type: 1
			}, function (data) {
				layer.closeAll('loading');
				trans_lock = 0;
				if (data.status == 1) {
					get_json_new();
					//$("#buy_price").val('');
					$("#buy_num").val('');
					//$("#sell_price").val('');
					$("#sell_num").val('');
					layer.msg(data.info, {icon: 1});
				} else {
					layer.msg(data.info, {icon: 2});
				}
			}, 'json');
		}


	}

	function tradeadd_sell() {
		if (trans_lock) {
			layer.msg('{#lang("不要重复提交")}', {icon: 2});
			return;
		}
		trans_lock      = 1;
		var price       = parseFloat($('#sell_price').val());
		var num         = parseFloat($('#sell_num').val());
		var paypassword = $('#sell_paypassword').val();
		if (price == "" || price == null) {
			layer.tips('{#lang("请输入内容")}', '#sell_price', {tips: 3});
			return false;
		}
		if (num == "" || num == null) {
			layer.tips('{#lang("请输入内容")}', '#sell_num', {tips: 3});
			return false;
		}
		layer.load(2);
		//此处演示关闭
		setTimeout(function () {
			layer.closeAll('loading');
			trans_lock = 0;
		}, 10000);


		var goole = "{$goole}";
		if (goole == 1) {
			layer.config({
				extend: 'extend/layer.ext.js'
			});
			layer.ready(function () {
				//默认prompt
				layer.prompt({
					title: '{#lang("输入谷歌验证码，并确认")}',
					formType: 1
				}, function (val) {
					if (val) {
						//需要执行的方法
						$.post("{#url('trade/up')}", {
							price: $('#sell_price').val(),
							num: $('#sell_num').val(),
							paypassword: $('#sell_paypassword').val(),
							market: "{$market}",
							type: 2,
							goole: val,
						}, function (data) {
							layer.closeAll('loading');
							trans_lock = 0;
							if (data.status == 1) {
								get_json_new();
								$("#buy_num").val('');
								$("#sell_num").val('');
								layer.msg(data.info, {icon: 1});
							} else {
								layer.msg(data.info, {icon: 2});
							}
						}, 'json');


					}
					;
				});
			});
		} else {

			$.post("{#url('trade/up')}", {
				price: $('#sell_price').val(),
				num: $('#sell_num').val(),
				paypassword: $('#sell_paypassword').val(),
				market: "{$market}",
				type: 2
			}, function (data) {
				layer.closeAll('loading');
				trans_lock = 0;
				if (data.status == 1) {
					get_json_new();
					$("#buy_num").val('');
					$("#sell_num").val('');
					layer.msg(data.info, {icon: 1});
				} else {
					layer.msg(data.info, {icon: 2});
				}
			}, 'json');
		}


	}



    $('#trade_top').hover(function () {
        $('#trade_list').show();
    }, function () {
        $('#trade_list').hide();
    });
    $('#trade_list').hover(function () {
        $('#trade_list').show();
    }, function () {
        $('#trade_list').hide();
    });

    $.post("/ajax/top_coin_menu?t=" + Math.random(), function (data) {
        if (data) {
            var interText = doT.template($("#trade_list_tpl").text());
            $("#trade_list").html(interText(data));

            var $li = $('#trade-nav-tabs > li');
            var $ul = $('#trade-nav-body > dl');

            $li.mouseover(function () {
                var $this = $(this);
                var $t = $this.index();
                $li.removeClass();
                $this.addClass('current');
                $ul.css('display', 'none');
                $ul.eq($t).css('display', 'block');
            })
        }
    }, "json");

    $('#game_top').hover(function () {
        $('#game_list').show();
    }, function () {
        $('#game_list').hide();
    });
    $('#game_list').hover(function () {
        $('#game_list').show();
    }, function () {
        $('#game_list').hide();
    });


    $('#user_top').hover(function () {
        $('#mywallet_list').show();
    }, function () {
        $('#mywallet_list').hide();
    });
    $('#mywallet_list').hover(function () {
        $('#mywallet_list').show();
    }, function () {
        $('#mywallet_list').hide();
    });


    $('#theme_top').hover(function () {
        $('#theme_list').show();
    }, function () {
        $('#theme_list').hide();
    });
    $('#theme_list').hover(function () {
        $('#theme_list').show();
    }, function () {
        $('#theme_list').hide();
    });
    $(document).ready(function () {
        var theme = $.cookies.get("theme");
        if (theme) {
            $('#theme').attr("href", "__CSS__/" + theme + ".css");
        } else {

        }
    });
    function chose_theme(theme) {
        $.cookies.set("theme", theme);
        window.location.reload();
    }


    $('#lang_top').hover(function () {
        $('#lang_list').show();
    }, function () {
        $('#lang_list').hide();
    });
    $('#lang_list').hover(function () {
        $('#lang_list').show();
    }, function () {
        $('#lang_list').hide();
    });

    $(document).ready(function () {
        var lang = $.cookies.get("lang");
        if (lang == "cn") {
            $('#lang-show').html('<i class="icon-lang-show icon-lang-chinese" style="margin-top:-8px;"></i>{#lang("简体中文")}');
        } else if (lang == "en") {
            $('#lang-show').html('<i class="icon-lang-show icon-lang-english" style="margin-top:-8px;"></i>English');
        } else if (lang == "hk") {
            $('#lang-show').html('<i class="icon-lang-show icon-lang-hongkong" style="margin-top:-8px;"></i>{#lang("繁体中文")}');
        }
    });
    function chose_lang(lang) {
        $.cookies.set("lang", lang);
        window.location.reload();
    }


    $('#moban_top').hover(function () {
        $('#moban_list').show();
    }, function () {
        $('#moban_list').hide();
    });
    $('#moban_list').hover(function () {
        $('#moban_list').show();
    }, function () {
        $('#moban_list').hide();
    });
</script>
<script>

    function autoHeight(main_body_height) {
		screen++;

	    if(screen>1){
		    main_body_height=300;
	    }

        var width  = $(window).width();
        var height = $(window).height();
        var chart_header = "60";
	    var main  = $(window).height() - chart_header;
        main_body_height = main_body_height ? main-main_body_height : main-30;


        if (width < 1400) {
            width = 1400;
        }
        $(".main_chart").css("width", width);
        $(".chart_header").css("width", width);
        $(".main_chart").css("height", main);

        $(".line-lift-block").css("width", width - 524);
	    $(".yincang .left").css("width", width - 524);
        $(".line-lift-block .main").css("height", main_body_height);
        $(".line-right-block").css("height", main_body_height);

        $(".left_block").css("height", main_body_height);

        $("#marketselllist").css("height", main_body_height / 2 - 40);

        $(".right_block").css("height", main_body_height);
        $(".left_block_sub1").css("height", main_body_height / 2 - 16);
        $(".left_block_sub2").css("height", main_body_height / 2 - 16);
        $(".log_block_body").css("height", main_body_height - 40);

    }
    window.onresize = autoHeight;

    $(function () {
        autoHeight();
        setTimeout(function () {
            $("#loading").hide();
            $('#marketselllist').scrollTop( $('#marketselllist')[0].scrollHeight);//卖单滚动到底部
        }, 1000);
    });
</script>
<script type="text/javascript">
    $(function () {
        $('.all_coin_price').hover(function () {
            $('.all_coin_list').show()
        }, function () {
            $('.all_coin_list').hide()
        });
       get_json();
        var $li = $('.trade-nav-move > dd');
        var $ul = $('#all_coins > ul');

        $li.mouseover(function () {
            var $this = $(this);
            var $t = $this.index();
            $li.removeClass();
            $this.addClass('current');
            $ul.css('display', 'none');
            $ul.eq($t).css('display', 'block');
        });
    });


    function get_json() {

        $.getJSON("/trade/chart_json/market/{$market}/t=" + Math.random(), function (data) {
            if (data) {
                if (data['menu']) {
                    trade_menu(data['menu']);
                }
                if (data['top']) {
                    trade_top(data['top']);
                }
                if (data['buy']) {
                    trade_buy(data['buy']);
                }
	            if (data['order']) {
		            $('#entrust_over').show();
		            trade_order(data['order']);
	            } else {
		            $('#entrust_over').hide();
	            }

                if (data['sell']) {
                    trade_sell(data['sell']);
                }
                if (data['log']) {
                    trade_log(data['log']);
	                trade_trades(data['log']);
                }
	            if (data['finance']) {
		            trade_finance(data['finance']);
	            }
            }
          //  setTimeout('get_json()', 5000);
        });
    }

    function trade_top(data) {
        if (data[0]) {
            $('#market_new_price').removeClass('buy');
            $('#market_new_price').removeClass('sell');
            if ($("#market_new_price").html() > data[0]) {
                $('#market_new_price').addClass('sell');
            }
            if ($("#market_new_price").html() < data[0]) {
                $('#market_new_price').addClass('buy');
            }
            $("#market_new_price").html(data[0]);
	        $("#table_newPrice").html(data[0]);
        }
        if (data[1]) {
            $('#market_buy_price').removeClass('buy');
            $('#market_buy_price').removeClass('sell');
            if ($("#market_buy_price").html() > data[1]) {
                $('#market_buy_price').addClass('sell');
            }
            if ($("#market_buy_price").html() < data[1]) {
                $('#market_buy_price').addClass('buy');
            }
            $("#market_buy_price").html(data[1]);
            $("#sell_best_price").html(data[1]);
        }
        if (data[2]) {
            $('#market_sell_price').removeClass('buy');
            $('#market_sell_price').removeClass('sell');
            if ($("#market_sell_price").html() > data[2]) {
                $('#market_sell_price').addClass('sell');
            }
            if ($("#market_sell_price").html() < data[2]) {
                $('#market_sell_price').addClass('buy');
            }
            $("#market_sell_price").html(data[2]);
            $("#buy_best_price").html( data[2]);
        }
        if (data[4]) {
            $("#market_max_price").html(data[4]);
        }
        if (data[3]) {
            $("#market_min_price").html(data[3]);
        }
        if (data[5]) {
            if (data[5] > 10000) {
                data[5] = (data[5] / 10000).toFixed(2) + "{#lang('万')}"
            }
            if (data[5] > 100000000) {
                data[5] = (data[5] / 100000000).toFixed(2) + "{#lang('亿')}"
            }
            $("#market_volume").html(data[5]);
        }
        if (data[6]) {
            $('#market_change').removeClass('buy');
            $('#market_change').removeClass('sell');
            if (data[6] > 0) {
                $('#market_change').addClass('buy');
                $("#market_change").html(data[6] + "%");
            } else {
                $('#market_change').addClass('sell');
                $("#market_change").html((-data[6]) + "%");
            }

        }
    }


    function trade_menu(data) {
        if (data) {
            for (var i in data) {
                $('.menu_price_zx_' + i).html(data[i]['price']);
            }
        }
    }

    function maxArrayKey(arr, key) {
        var a = 0;

        for (var i in arr) {
            a = Math.max(arr[i][key], a);
        }
        return a;
    }

    function trade_buy(data) {
        var list = '';
        var maxNums;
        maxNums = maxArrayKey(data, 1) / 2;
        for (var i in data) {
	        if(i>19){
		        break;
	        }
            list += '<tr>' +
                    '<td class="buy"  width="50">{#lang("买")}' + (parseFloat(i) + 1) + '</td>' +
                    '<td class="buy"  width="80">' + data[i][0] + '</td>' +
                    '<td class="buy"  width="120">' + data[i][1] + '</td>' +
                    '</tr>';
        }
        $("#marketbuylist").html(list);
    }

    function trade_sell(data) {
        var list = '';
        var maxNums;
        maxNums = maxArrayKey(data, 1) / 2;
        var len = data.length;
        for (var i in data) {
	        if(i>19){
		        break;
	        }

            list += '<tr>' +
                    '<td class="sell"  width="50">{#lang("卖")}' + (len - parseFloat(i)) + '</td>' +
                    '<td class="sell"  width="80">' + data[i][0] + '</td>' +
                    '<td class="sell"  width="120">' + data[i][1] + '</td>' +
                    '</tr>';
        }
        $("#marketselllist").html(list);
    }


    function trade_log(data) {
        var list = '';
        var maxNums;
        var type;
        for (var i in data) {

            if (data[i][1] == 1) {
                type = 'buy';
            } else {
                type = 'sell';
            }
            list += '<tr>' +
                    '<td class="' + type + '"  width="70">' +formatDate(data[i][0]) + '</td>' +
                    '<td class="' + type + '"  width="70">' + data[i][2] + '</td>' +
                    '<td class="' + type + '"  width="100">' + data[i][3] + '</td>' +
                    '</tr>';
        }

        $("#marketorderlist").html(list);
    }
    function formatDate(now) {

	    var time = new Date(now);
	    var h = time.getHours();//时
	    var mm = time.getMinutes();//分
	    var s = time.getSeconds();//秒
	    return h+":"+mm+":"+s;
    }
    function formatDateII(now) {
	    var time = new Date(now);
	    var y = time.getFullYear();//年
	    var m = time.getMonth() + 1;//月
	    var d = time.getDate();//日
	    var h = time.getHours();//时
	    var mm = time.getMinutes();//分
	    var s = time.getSeconds();//秒
	    return y+"-"+m+"-"+d+" "+h+":"+mm+":"+s;
    }
</script>
<div class="clear">
</div>
<div id="all_mask" class="all_mask" style="height: 0px; display: none;"></div>
<div id="all_mask_loginbox" class="all_mask_loginbox" style="display: none;">
    <div class="login_title pl20" style="">{#lang('登录')}</div>
    <form id="form-login" class="mask_wrap login-fb">
        <div class="login_text zin90">
            <div class="mask_wrap_title" style="">{#lang('手机号')}：</div>
            <input type="text" id="login_mobles" class="texts" style="display: none;"><input type="text" id="login_moble" class="texts hg40 w250" placeholder="{#lang('请输入手机号码')}" style="height:40px;line-height:40px;background:none;color:#000;padding-left: 42px;"/>
            <link rel="stylesheet" href="__EXT__/intlTelInput/css/intlTelInput.css">
            <script src="__EXT__/intlTelInput/js/intlTelInput.js"></script>
            <script>
                $("#login_mobles").intlTelInput({
                    autoHideDialCode: false,
                    defaultCountry: "cn",
                    nationalMode: false,
                    preferredCountries: ['cn', 'us', 'hk', 'tw', 'mo'],
                });
            </script>
        </div>
        <div class="login_text zin80">
            <div class="mask_wrap_title" style="">{#lang('密码')}：</div>
            <input id="login_password" class="texts hg40 w250" type="password" placeholder="{#lang('请输入登录密码')}" style="height:40px;line-height:40px;background:none;color:#000;">
        </div>
        <div class="login_text zin80">
            <div class="mask_wrap_title" style="">{#lang('验证码')}：</div>
            <input type="text" id="login_verify" value="" class="texts w145 hg40" placeholder="{#lang('请输入验证码')}" style="height:40px;line-height:40px;background:none;color:#000;width:145px">
			<span style="vertical-align: -17px;line-height: 20px;">
				<img id="login_verify_up" class="codeImg reloadverify hg40" src="{#url('ajax/verify')}" title="{#lang('换一张')}" onclick="login_verify_ups();" width="100" height="34">
			</span>
        </div>
        <div class="login_button">
            <input type="button" value="{#lang('登录')}" onclick="footer_login();" class="btns2  hg40 w250">
        </div>
        <div class="login-footer wwxwwx" style="border-bottom-left-radius: 3px; border-bottom-right-radius: 3px;">
			<span style="color: #CCC; float: right; margin-right: 25px;">
			<a style="font-size: 12px;" href="/reg">{#lang('免费注册')}</a>｜<a href="/findpwd" style="font-size: 12px;">{#lang('忘记密码')}</a></span>
        </div>
    </form>
    <div class="mask_wrap_close" onclick="wrapClose()"><i class="fa fa-times fz_20 move" aria-hidden="true"></i></div>
</div>


<div id="all_mask_goolebox" class="all_mask_loginbox" style="display: none;">
    <div class="login_title pl20">{#lang('谷歌验证')}</div>
    <form id="form-goole" class="mask_wrap login-fb">
        <div class="login_text zin80">
            <div class="mask_wrap_title">{#lang('谷歌密码')}：</div>
            <input id="goole_password" class="texts hg40 w250" type="password" placeholder="{#lang('请输入谷歌密码')}">
        </div>
        <div class="login_button">
            <input type="button" value="{#lang('验证')}" onclick="footer_goole();" class="btns2  hg40 w250">
        </div>
    </form>
    <div class="mask_wrap_close" onclick="wrapClose()"><i class="fa fa-times fz_20 move" aria-hidden="true"></i></div>
</div>
<script>

    $(function () {
        var userid = "{$userid}";
        if (window.location.hash == '#login') {
            if (!userid) {
                loginpop();
            }
        }

//        check_zzc();

        if (window.location.hash == '#goole') {
            goolepop();
        }


        var move_moble = $.cookies.get('move_moble');
        if (move_moble != '' && move_moble != null) {
            $("#login_moble").val(move_moble);
        }
    });
    function check_zzc() {
        $.getJSON("/ajax/check_zzc/t=" + Math.random(), function () {

            setTimeout('check_zzc()', 5000);
        });
    }
    function login_verify_ups() {
        $('#login_verify_up').attr('src', "{#url('ajax/verify')}?t=" + Math.random());
    }

    function loginpop() {
        var height = $(document).height();
        if (height < 1000) {
            height = 1000;
        }
        $('.all_mask').css({'height': height});
        $('.all_mask').show();
        $('#all_mask_loginbox').show();
    }

    function goolepop() {
        var height = $(document).height();
        if (height < 1000) {
            height = 1000;
        }
        $('.all_mask').css({'height': height});
        $('.all_mask').show();
        $('#all_mask_goolebox').show();
    }



    function wrapClose() {
        $('.all_mask').hide();
        $('.all_mask_loginbox').hide();
    }
    function footer_login() {
        var moble    = $("#login_moble").val();
        var mobles   = $("#login_mobles").val();
        var password = $("#login_password").val();
        var verify   = $("#login_verify").val();

        if (moble == "" || moble == null) {
            layer.tips('{#lang("请输入手机号")}', '#login_moble', {tips: 2});
            return false;
        }
        if (password == "" || password == null) {
            layer.tips('{#lang("请输入登录密码")}', '#login_password', {tips: 2});

            return false;
        }
        if (verify == "" || verify == null) {
            layer.tips('{#lang("请输入验证码")}', '#login_verify', {tips: 2});
            return false;
        }

        $.post("{#url('login/up_login')}", {
            moble: moble,
            mobles: mobles,
            password: password,
            verify: verify,
            login_token: "{$login_token}",
        }, function (data) {
            if (data.status == 1) {
                layer.msg(data.info, {icon: 1});
                if (data.url) {
                    window.location = data.url;
                } else {
                    window.location.reload();
                }
            } else {
                layer.msg(data.info, {icon: 2});
                if (data.url) {
                    window.location = data.url;
                }
            }
        }, "json");
    }



    function footer_goole() {
        var password = $("#goole_password").val();



        if (password == "" || password == null) {
            layer.tips('{#lang("请输入谷歌密码")}', '#goole_password', {tips: 2});
            return false;
        }

        $.post("{#url('login/goole')}", {
            password: password,
        }, function (data) {
            if (data.status == 1) {
                layer.msg(data.info, {icon: 1});
                if (data.url) {
                    window.location = data.url;
                } else {
                    window.location='/';
                }
            } else {
                layer.msg(data.info, {icon: 2});
                if (data.url) {
                    window.location = data.url;
                }
            }
        }, "json");
    }
</script>
</body>
<script>
    //执行class="mv-hide" 内代码
    $(document).ready(function () {
        $.each($(".mv-hide"), function () {
            eval($(this).html());
        });
    });
</script>
</html>



