<?phpnamespace model;use Move\db;class help extends common{	public function send($id, $type)	{		db::exec("set autocommit = 0");		db::exec("lock tables #pre#help_news write,#pre#help_newslog write,#pre#user write ");		foreach ($id as $v) {			$newslog = db::table("help_newslog")->where(["id" => $v])->find();			$alluser = db::table("user")->field("id")->select();			foreach ($alluser as $val) {				$data = ["userid" => $val["id"], "newsid" => $v, "title" => $newslog["title"], "content" => $newslog["content"], "addtime" => time(), "status" => 2];				$rs = [];				if ($type == 1) {					$rs[] = db::table("help_news")->add($data);				} else {					if (db::table("help_news")->where(["newsid" => $v])->find()) {						$rs[] = db::table("help_news")->where(["newsid" => $v])->delete();					}				}			}			$status = 0;			if ($type == 1) {				$status = 1;			}			$rs[] = db::table("help_newslog")->where(["id" => $v])->save(["status" => $status]);		}		if (check_arr($rs)) {			db::exec("commit");			db::exec("unlock tables");			return ["操作成功", 1];		} else {			db::exec("rollback");			db::exec("unlock tables");			return ["操作失败" . implode("|", $rs)];		}	}}