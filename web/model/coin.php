<?phpnamespace model;use Move\db;use Move\ext\page;class coin extends common{	public $mc_data = [];	public $err = "";	public function init()	{		if ($this->mc_data) {			return true;		}		$data = mc('msphp_coin');		if ($data) {			$this->mc_data = $data;			return true;		}		$res = db::table('coin')->select();		if (!$res) {			return false;		}		foreach ($res as $k => $v) {			$data[$v['name']] = $v;			$data[$v['id']] = $v;		}		mc('msphp_coin', $data);		$this->mc_data = $data;		return true;	}	public function getByName($name = null)	{		$this->init();		return isset($this->mc_data[$name]) ? $this->mc_data[$name] : "";	}	public function getById($id = null)	{		$this->init();		return isset($this->mc_data[$id]) ? $this->mc_data[$id] : "";	}	public function mc($name = null)	{		$mymc_coin = new \mymc\coin();		$coin = $mymc_coin->select();		if ($name) {			if (check($name, 'w') && isset($coin[$name]) && $coin[$name]) {				return $coin[$name];			} else {				return [];			}		}		if (isset($coin['list']) && $coin['list']) {			return $coin['list'];		} else {			return [];		}	}	public function get_info($id = null)	{		if (!$id) {			return false;		}		return db::table("coin")->where(["id" => $id])->find();	}	public function all_xnb($where = [])	{		if (!$where) {			$where = ["status" => 1, "type" => "xnb"];		}		$val = null;		$data = [];		$res = db::table("coin")->where($where)->order("`sort` ASC")->select();		if (!is_array($res)) {			return false;		}		foreach ($res as $val) {			$data[$val["name"]] = $val;		}		return $data;	}	public function all_xnb_title($where = [])	{		if (!$where) {			$where = ["status" => 1, "type" => "xnb"];		}		$val = null;		$data = [];		$res = db::table("coin")->where($where)->order("`sort` ASC")->select();		if (!is_array($res)) {			return false;		}		foreach ($res as $val) {			$data[$val["name"]] = $val["title"];		}		return $data;	}	public function lists($where = [])	{		if (!$where) {			$where = ["status" => 1];		}		$val = null;		$data = [];		$res = db::table("coin")->where($where)->order("`sort` ASC")->select();		if (!is_array($res)) {			return false;		}		foreach ($res as $val) {			$data[$val["name"]] = $val;		}		return $data;	}	public function find($where = [])	{		if (!$where) {			$where = ["status" => 1];		}		$res = db::table("coin")->where($where)->find();		if ($res) {			return $res;		} else {			return false;		}	}	public function xnb_menu($where = [])	{		if (!$where) {			$where = ["status" => 1, "type" => "xnb"];		}		$val = null;		$data = [];		$res = db::table("coin")->where($where)->order("`sort` ASC")->select();		if (!is_array($res)) {			return false;		}		foreach ($res as $val) {			$data[$val["name"]] = $val["title"];		}		return $data;	}	public function check_cny()	{		$res = db::table("coin")->where(["name" => "cny"])->find();		if (!$res) {			db::table("coin")->add(["name" => "cny", "title" => "人民币", "type" => "rmb", "img" => "coin/cny.png", "round" => 2, "addtime" => time(), "status" => 1]);			db::exec("ALTER TABLE  `move_user_coin` ADD  `cny` DECIMAL(20,8) UNSIGNED NOT NULL");			db::exec("ALTER TABLE  `move_user_coin` ADD  `cnyd` DECIMAL(20,8) UNSIGNED NOT NULL");		}	}	public function save($where = [], $save = [])	{		if (!$where) {			return false;		}		if (!$save) {		}		$res = db::table("coin")->where($where)->save($save);		if (!$res) {			return false;		}		return $res;	}	public function all_xnb_list()	{		$val = null;		$data = [];		$res = db::table("coin")->where(["status" => 1, "name#<>" => "cny"])->order("`sort` ASC")->select();		if (!is_array($res)) {			return false;		}		foreach ($res as $val) {			$data[$val["name"]] = $val;		}		return $data;	}	public function page_coin_out($where = [], $size = 10, $order = "`id` desc")	{		$table = "coin_out";		$count = db::table($table)->where($where)->count();		$page_obj = new page($count, $size);		$show = $page_obj->show();		$list = db::table($table)->where($where)->order($order)->limit($page_obj->firstRow, $page_obj->listRows)->select();		return ["list" => $list, "show" => $show];	}}